define("widget/pay",["lib/zepto","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","business/common","piggy/util/cacheData","piggy/util/tpl","piggy/util/report","business/pay","piggy/util/string"],function(a,b,c){
var d,e=a("lib/zepto"),f=(a("business/router"),a("business/common")),g=(a("business/jsbridge"),a("business/pay")),h=a("piggy/util/tpl");b.init=function(a){a=e.extend({pure_bg:!0},a),f.loadCss(window.location.protocol+"//cdn.vip.qq.com/club/client/comic/release/css/recharge_dialog.css?max_age=25920000"),
d=a.compassReport,a.pure_bg&&e("body").addClass("pure_bg")},b.closePayWrap=function(a){e("#charge_wrap").remove(),e("body").removeClass("pure_bg")},b.queryCharge=function(a){d&&d.send({oper_obj_type:"2",
oper_obj_id:20060}),e("#charge_wrap").length?e("#charge_wrap").addClass("show").show():g.getCouponList({},function(c){0==c.result&&c.data&&c.data.coupon&&c.data.coupon.length?e("#charge_wrap").length?e("#charge_wrap").addClass("show").show():e("body").append(h.get(i,{
data:c.data,outerCb:a},h.getInstance({action:b}))):c&&c.result&&120099==c.result?f.showTips(c.message):f.showTips("获取充值信息失败，请稍后重试")})},b.clickCharge=function(a,b,c){var h=this,i=(arguments.callee,{});b&&(h.closePayWrap(),
e.extend(b,{count:b.count,aid:"qqcomic.client.flooract."+b.count}),d&&d.send({oper_obj_type:"2",oper_obj_id:20094,ext3:status,report_path:!0}),g.charge(b,function(a){var e;i.timeout||(0==a.result?(c(0,b),
e=0):2!=a.result&&6!=a.result?(f.showTips("系统繁忙，请稍后再试"),e=1,c(1,b)):(e=2,c(1,b)),d&&d.send({oper_obj_type:"2",oper_obj_id:20094,ext3:e,report_path:!0})),i.getResult=!0}),setTimeout(function(){i.timeout=!0,
i.getResult||c(2,b)},1e4))};var i='<div id="charge_wrap" class="ui-dialog show">                <div class="ui-dialog-cnt">                    <i class="ui-dialog-close" onclick="<%=this.getInvoke(\'action.closePayWrap\')%>"></i>                    <div class="ui-dialog-bd">                         <h4>点券充值</h4>                         <ul class="ticket-list">                            <% for(var i = 0, max = data.coupon.length, obj; obj = data.coupon[i], i < max; i++){ %>                                <li onclick="<%=this.getInvoke(\'action.clickCharge\', obj, outerCb)%>">                                    <div class="ticket">                                        <p><%=obj.count%>点券</p>                                    </div>                                    <div class="money"><em><span class="num"><%=(Math.round(obj.price) / 100).toFixed(2)%></span>元</em></div>                                </li>                            <%}%>                        </ul>                    </div>                </div>            </div>';
});