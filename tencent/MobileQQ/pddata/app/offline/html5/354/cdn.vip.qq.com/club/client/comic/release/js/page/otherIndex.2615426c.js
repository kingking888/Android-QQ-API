define("page/otherIndex",["lib/zepto","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","business/common","piggy/util/cacheData","piggy/util/tpl","piggy/util/report","business/comic","piggy/util/string","widget/WVUtil","piggy/util/net","business/security","widget/fullScreen"],function(a,b,c){
var d=a("lib/zepto"),e=a("business/router"),f=a("business/common"),g=a("business/comic"),h=a("piggy/util/tpl"),i=a("piggy/util/string"),j=a("piggy/util/cacheData"),k=a("piggy/util/process"),l=a("widget/fullScreen"),m={},n={},o=!0,p=null,q=null,r={};
r.commonListTpl='<%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><section class="<%=obj.typeClassName%><%=obj.id==1127 ? \' gold\' : \'\'%>" data-modtype="<%=obj.type%>" data-modid="<%=obj.id%>"  ><%if(obj.name && !obj.showModuleName){%><h2><%=priv.processTitle(obj.name)%><%if(obj.desc){%><span class="ui-panel-subtitle"><%=this.getData("string.encodeHTML", obj.desc)%></span><%}%><%if(obj.isMulti){%><span class="ui-panel-title-tips icon-refresh" data-position="<%=i + 1%>"  onclick="<%=this.getInvoke(\'action.clickMultiChange\', obj)%>"  data-modtype="<%=obj.type%>" data-modname="<%=obj.name%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300082, "ret_id": "", "ses_id":"<%=obj.name%>", "algo_id":"<%=obj.rule%>", "ext3": "<%=i+1%>", "ext8": "<%=option.gColdLaunch%>"}\'>换一批</span><%}%></h2><%}%><%=tpl.get(priv.getCommonListTpl(obj.type), {algorithmList:obj.algorithmList,moduleId:obj.id, list:obj.list, moduleName:obj.name, moduleType:obj.type, rule:obj.rule, option:option, position: i + 1}, tpl.getInstance({newIndex:newIndex, string:string}))%><%if(((obj.type >= 2 && obj.type <= 9) || (obj.type >= 16 && obj.type <= 18 || obj.type == 13)) && obj.headerImg){%><div class="ui-img-cover cover-lg" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickHeadImg\', obj, option)%>" data-modtype="<%=obj.type%>" data-modname="<%=obj.name%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300009, "ret_id": "", "ses_id":"<%=obj.name%>", "algo_id":"<%=obj.rule%>", "ext3": "<%=i+1%>", "ext8": "<%=option.gColdLaunch%>"}\'><span data-url="<%=obj.headerImg%>"></span></div><%}%><%if(obj.watchMoreDesc){%><div class="ui-panel-more ui-border-t" data-position="<%=i+1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickModule\', obj, option)%>" data-clicktype="1" data-modtype="<%=obj.type%>" data-modname="<%=obj.name%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300008, "ses_id":"<%=this.getData("string.encodeHTML", obj.name)%>", "ret_id": "<%=this.getData("string.encodeHTML", obj.watchMoreDesc)%>", "ses_id":"<%=this.getData("string.encodeHTML", obj.name)%>", "algo_id":"<%=obj.rule%>", "ext3": "<%=i+1%>", "ext8": "<%=option.gColdLaunch%>"}\'><span class="ui-arrowlink"><%=this.getData("string.encodeHTML", obj.watchMoreDesc)%></span></div><%}%></section><%}%>',
r.keepReedTpl='<div class="guide-bar"><span class="<%if(showAnimate){%>animated slideInLeftAndShake<%}%>" onclick="<%=this.getInvoke(\'action.clickKeepRead\', data)%>"><%=this.getData("string.encodeHTML", data.showName)%></span></div>',
r.getCommonListTpl=function(a){var b="";switch(a){case 2:case 3:case 4:case 5:case 16:case 17:b='<ul data-mod-wrap="<%=moduleId%>"><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-id="<%=obj.id%>" data-source="<%=obj.algorithmSource%>" data-scene="<%=algorithmList[1].sBusiId%>" data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickComic\', obj, option)%>"data-modtype="<%=moduleType%>"  data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>",  "ext2": "<%=obj.type%>", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-vertical"><%if(obj.operateTag && obj.operateTag != "无"){%><i class="<%if(obj.operateTag.length == 2){%>ui-corner-s<%}else if(obj.operateTag.length == 3){%>ui-corner<%}else{%>ui-corner-lg<%}%>"><%=obj.operateTag%></i><%}%><span data-url="<%=obj.operateImg ? obj.operateImg : obj.coverImg%>"></span><%if(obj.readDesc !== ""){%><div class="panel-tag-mask"></div><div class="panel-tag <%if(obj.showType != 2 && obj.showType != 3){%><%if(obj.type >= 100 && obj.type <= 300){%>panel-tag-anmie<%}else{%>panel-tag-view<%}%><%}%>"><%=obj.readDesc%></div><%}%></div><div class="ui-grid-info ui-border-r"><h4 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.name)%></h4><p class="ui-nowrap"><%=obj.oneWord ? this.getData(\'string.encodeHTML\', obj.oneWord) : ("更新至" + obj.sectionCount + (obj.type >= 100 && obj.type <= 300 ? "集" : "话"))%></p></div></li><%}%><%}%></ul>';
break;case 6:case 7:case 8:case 9:b='<ul data-mod-wrap="<%=moduleId%>"><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickComic\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "<%=obj.type%>", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-horizontal"><%if(obj.operateTag && obj.operateTag != "无"){%><i class="<%if(obj.operateTag.length == 2){%>ui-corner-s<%}else if(obj.operateTag.length == 3){%>ui-corner<%}else{%>ui-corner-lg<%}%>"><%=obj.operateTag%></i><%}%><span data-url="<%=obj.operateImg ? obj.operateImg : obj.coverImg%>"></span><%if(obj.readDesc !== ""){%><div class="panel-tag-mask"></div><div class="panel-tag <%if(obj.showType != 2 && obj.showType != 3){%><%if(obj.type >= 100 && obj.type <= 300){%>panel-tag-anmie<%}else{%>panel-tag-view<%}%><%}%>"><%=obj.readDesc%></div><%}%></div><div class="ui-grid-info ui-border-r"><h4 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.name)%></h4><p class="ui-nowrap"><%=obj.oneWord ? this.getData(\'string.encodeHTML\', obj.oneWord) : ("更新至" + obj.sectionCount + (obj.type >= 100 && obj.type <= 300 ? "集" : "话"))%></p></div></li><%}%><%}%></ul>';
break;case 10:case 23:b='<ul class="kbn-list"><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickComic\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "<%=obj.type%>", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img"><span data-url="<%=obj.operateImg ? obj.operateImg : obj.coverImg%>"></span><div class="panel-tag-mask"></div><%if(obj.readDesc){%><div class="panel-tag panel-tag-view"><%=obj.readDesc%></div><%}%></div><div class="kbn-info"  data-url="<%=obj.imgUrl%>"><h3 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.name)%></h3><p class="ui-nowrap"><%=obj.oneWord ? this.getData(\'string.encodeHTML\', obj.oneWord) : ("更新至" + obj.sectionCount + (obj.type >= 100 && obj.type <= 300 ? "集" : "话"))%></p><ul class="ui-label-list"><%if(obj.tagDesc){%><%=obj.tagDesc%><%}%></ul><%if(obj.targetUrl){%><%=i==0 ? \'<div class="bubble"></div>\' : ""%><div class="avatar-kbn" data-stopprop="true" data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=this.getData("string.encodeHTML", obj.mainTitle)%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "400", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'></div><%}%></div></li><%}%><%}%></ul>';
break;case 11:b='<ul><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=this.getData("string.encodeHTML", obj.mainTitle)%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "400", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-horizontal"><span data-url="<%=obj.imgUrl%>"></span></div><div class="ui-grid-info ui-border-r"><h4 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.mainTitle)%></h4><p class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.oneWord)%></p></div></li><%}%><%}%></ul>';
break;case 12:b='<ul><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-position="<%=position%>" data-seq="<%=i + 1%>" class="cover" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickComic\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "<%=obj.type%>", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-cover cover-lg"><span data-url="<%=obj.operateImg ? obj.operateImg : obj.coverImg%>"></span></div><div class="info"><div class="txt"><h3 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.name)%></h3><%if(obj.readDesc !== ""){%><div class="panel-tag panel-tag-view"><%=obj.readDesc%></div><%}else{%><p class="ui-nowrap"><%=obj.oneWord ? this.getData(\'string.encodeHTML\', obj.oneWord) : ("更新至" + obj.sectionCount + (obj.type >= 100 && obj.type <= 300 ? "集" : "话"))%></p><%}%></div><button class="ui-btn" onclick="<%=this.getInvoke(\'newIndex.clickReadSection\', obj)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300010, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2":"<%=obj.destSectionId%>", "ext3": "<%=i+1%>", "ext8": "<%=option.gColdLaunch%>"}\'>看<%=obj.destSectionName%></button></div></li><%}%><%}%></ul>';
break;case 13:b='<ul><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><li data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickComic\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=obj.id%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "<%=obj.type%>", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-vertical"><%if(obj.operateTag && obj.operateTag != "无"){%><i class="<%if(obj.operateTag.length == 2){%>ui-corner-s<%}else if(obj.operateTag.length == 3){%>ui-corner<%}else{%>ui-corner-lg<%}%>"><%=obj.operateTag%></i><%}%><span data-url="<%=obj.operateImg ? obj.operateImg : obj.coverImg%>"></span><%if(obj.readDesc !== ""){%><div class="panel-tag-mask"></div><div class="panel-tag <%if(obj.showType != 2 && obj.showType != 3){%><%if(obj.type >= 100 && obj.type <= 300){%>panel-tag-anmie<%}else{%>panel-tag-view<%}%><%}%>"><%=obj.readDesc%></div></div><%}%><div class="ui-grid-info ui-border-r"><h4 class="ui-nowrap"><%=this.getData(\'string.encodeHTML\', obj.name)%></h4><p class="ui-nowrap"><%=obj.oneWord ? this.getData(\'string.encodeHTML\', obj.oneWord) : ("更新至" + obj.sectionCount + (obj.type >= 100 && obj.type <= 300 ? "集" : "话"))%></p></div></li><%}%><%}%></ul>';
break;case 18:b='<% var listLen = list.length, topItem=list[0], leftItem=list[1], rightItem=list[1]; %><% if(listLen==3){ %><div class="ui-img-cover bg-orange" data-position="<%=position%>" data-seq="<%=1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', topItem, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=this.getData("string.encodeHTML", topItem.mainTitle)%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "400", "ext3": "<%=position%>", "ext4": "<%=1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><span></span><div class="content"><div class="info"><h3 class="title ui-nowrap"><%=this.getData(\'string.encodeHTML\', topItem.imgTitle)%></h3><p class="sub-title ui-nowrap"><%=this.getData(\'string.encodeHTML\', topItem.imgSubTitle)%></p><span class="amount ui-arrowlink"><%=this.getData(\'string.encodeHTML\', topItem.imgDesc)%></span></div><div class="book-list"><% var coverImgs = topItem.coverImgs || []; %><%for(var i = 0, max = coverImgs.length, coverUrl; coverUrl = coverImgs[i], i < max; i++){%><div class="ui-img"><span data-url="<%=coverUrl%>"></span></div><%}%></div></div></div></div><div class="ui-grid ui-grid-bisect list-album-sub"><ul><%for(var i = 1, max = list.length, obj; obj = list[i], i < max; i++){%><li data-position="<%=position%>" data-seq="<%=i+1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=this.getData("string.encodeHTML", obj.mainTitle)%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "400", "ext3": "<%=position%>", "ext4": "<%=1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><div class="ui-img-horizontal bg-<%= i==1?\'green\':\'pink\'%>"><span></span><div class="content"><div class="info"><h3 class="title ui-nowrap-multi"><%=this.getData(\'string.encodeHTML\', obj.imgTitle)%></h3><span class="amount ui-arrowlink"><%=this.getData(\'string.encodeHTML\', obj.imgDesc)%></span></div><div class="book-list"><div class="ui-img"><span data-url="<%=obj.coverImgs[0]%>"></span></div><div class="bg-opacity"></div></div></div></div></li><%}%></ul></div><%}%>';
break;case 19:case 20:case 21:var c=19==a,d=20==a;b='<div class="swiper-container swiper-container-horizontal swiper-container-free-mode"><ul class="swiper-wrapper"><%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj && max>1){%><li class="swiper-slide" data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "<%=this.getData("string.encodeHTML", obj.mainTitle)%>", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "400", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'>'+(c?'<div class="sort-wrap">':"")+(d?'<div class="studio-wrap">':"")+'<div class="ui-img"><span data-url="<%=obj.imgUrl%>"></span></div>'+(c?"</div><p><%=this.getData('string.encodeHTML', obj.imgTitle || obj.categoryName || '')%></p>":"")+(d?"</div>":"")+"</li><%}%><%}%></ul></div>";
break;default:b='<%for(var i = 0, max = list.length, obj; obj = list[i], i < max; i++){%><%if(obj){%><div class="ui-img-cover" data-position="<%=position%>" data-seq="<%=i + 1%>" data-qta="openUrl" onclick="<%=this.getInvoke(\'newIndex.clickActLink\', obj, option)%>" data-modtype="<%=moduleType%>" data-modname="<%=moduleName%>" data-moduleid="<%=moduleId%>" data-rule="<%=rule%>" data-report=\'{"obj_id":10041, "oper_obj_type": 3, "oper_obj_id": 300007, "ret_id": "", "ses_id":"<%=moduleName%>", "algo_id":"<%=rule%>", "ext2": "500", "ext3": "<%=position%>", "ext4": "<%=i+1%>", "ext5":"<%=moduleId%>", "ext8": "<%=option.gColdLaunch%>"}\'><span data-url="<%=obj.imgUrl%>"></span></div><%}%><%}%>';
}return b},r.processTitle=function(a){return a?(a=a.replace(/\w+/g,function(a){return"#bstart#"+a+"#bend#"}),a=i.encodeHTML(a)||"",a=a.replace(/#bstart#/g,"<b>").replace(/#bend#/g,"</b>"),a="<span>"+a+"</span>"):"<span></span>";
},b.getNewIndexCommonList=function(a,b){var c=this,g=7200,h=1,i="otherIndexCommonListV2";return j.getWithListStruct({},[i],"comic/otherIndexCommonListV2",function(b,g,h){k.lockNext(b,"comic/otherIndexCommonListV2",function(a){
h(a&&0==a.result&&a.data?{result:0,data:{otherIndexCommonListV2:a.data}}:a)},function(b){var g={module:"comic_new_mainpage_mt_svr",method:"GetNewModuleListV2",param:{type:1,ids:a.mapList,version:1,isSingle:0,
newTag:1}};f.sendMergeRequest({url:e.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),plugins:{"piggy/util/time":/^[\w]+:\/\/[\w\-\.]+\.vip\.qq\.com\//},data:g,callback:function(a){if(a&&0==a.result&&a.data&&a.data.list){
var e=a.data.list,f=[],g=[],h=null;r.items={};for(var i in e){if(h=d.extend(!0,{},e[i]),c.isComic(e[i].type)){h.list=[];for(var j=0;j<e[i].list.length;j++)r.items[e[i].list[j].id]?r.items[e[i].list[j].id]=d.extend(r.items[e[i].list[j].id],e[i].list[j]):r.items[e[i].list[j].id]=e[i].list[j],
h.list.push(e[i].list[j].id),g.push(e[i].list[j].id)}f.push(h)}c.get({idList:g},function(a){}),a={result:0,data:f}}b(a)}})})},function(a){if(a&&a.data&&a.data.otherIndexCommonListV2){var d=a.data.otherIndexCommonListV2,e=[],f=[];
for(var g in d)if(c.isComic(d[g].type))for(var h=0;h<d[g].list.length;h++)e.push(d[g].list[h]);if(r.items){for(var g in d)if(c.isComic(d[g].type)){for(var h=0;h<d[g].list.length;h++)d[g].list[h]=r.items[d[g].list[h]];
f.push(d[g])}else f.push(d[g]);r.items=null,a.data=f,b(a)}else c.get({idList:e},function(a){if(a&&0==a.result){for(var e in d)if(c.isComic(d[e].type)){for(var g=0;g<d[e].list.length;g++)d[e].list[g]=a.data[d[e].list[g]];
f.push(d[e])}else f.push(d[e]);a.data=f,b(a)}else b(a)})}else b(a)},g,h)},b.getDisorderedMultiList=function(a,b){f.sendMergeRequest({url:e.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),plugins:{"piggy/util/time":/^[\w]+:\/\/[\w\-\.]+\.vip\.qq\.com\//
},data:{module:"comic_new_mainpage_mt_svr",method:"GetNewModuleListV2",param:{type:1,ids:a.mapList,version:1,isSingle:1}},callback:function(a){if(a&&0==a.result&&a.data&&a.data.list){var c=a.data.list,d={
result:0,data:c};b(d)}else b({result:-6})}})},b.getOrderedMultiList=function(a,b){f.sendMergeRequest({url:e.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),plugins:{"piggy/util/time":/^[\w]+:\/\/[\w\-\.]+\.vip\.qq\.com\//
},data:{module:"comic_new_mainpage_mt_svr",method:"GetNewModuleDetailV2",param:{type:1,ids:a.mapList,page:a.page}},callback:function(a){if(a&&0==a.result&&a.data&&a.data.list){var c=[a.data.list],d={result:0,
data:c};b(d)}else b({result:-6})}})},b.isVideo=function(a){var b={6:1,7:1,8:1,9:1};return b[a]?!0:!1},b.getPageSize=function(a){var b={3:3,5:6,7:2,9:4,16:3,17:6};return b[a]},b.isComic=function(a){var b={
2:1,3:1,4:1,5:1,13:1,16:1,17:1};return b[a]?!0:!1},b.needShowType=function(a){var b=this;return b.isComic(a)||b.isVideo(a)?!0:12==a||10==a||23==a},b.isAutoRecommendType=function(a){var b={3:1,5:1,7:1,9:1,
16:1,17:1};return b[a]?!0:!1},b.get=function(a,b){var c=3600,e=60,g=a.idList,h=null,i=null;return j.getWithListStruct({},g,"comic/newItem",function(a,b,c){k.lockNext(a,"comic/newItem",function(a){c(a)},function(b){
if(r.items){for(var c={},e=0;e<a.length;e++)c[a[e]]=r.items[a[e]];b({result:0,data:c})}else{var g={src:1,cmd:{detail:{module:"comic",method:"getComicSummaryInfo",param:{comicID:a}}}},h={param:JSON.stringify(g)
};f.sendRequest({data:h,callback:function(a){if(a&&a.data&&a.data.detail){var c=a.data.detail;if(c&&0==c.retCode){c=c.retBody||{};var e={};if(0==c.result){for(var f=0;f<c.data.length;f++){var g="comic/newItem__"+c.data[f].id,h=j.get(g);
e[c.data[f].id]=h?d.extend(!0,h,c.data[f]):c.data[f]}c.data=e}b(c)}else b({result:-5})}else b({result:-6})}})}})},function(a){b(a)},"undefined"==typeof h||null===h?c:h,"undefined"==typeof i||null===i?e:i);
},b.init=function(b,c,d){var e=this;r.newIndex=c,p=d.compassReport,q=d.gColdLaunch,e.showCommonList(b,d.mapList),p.send({oper_obj_type:"999",oper_obj_id:200257}),l&&l.setSticky&&l.setSticky(),e.showLastReadBtn(),
f.compareVersion(f.QQVersion,"6.3")>=0?f.setDocumentTitle("波洞星球"):f.setDocumentTitle("动漫"),e.forbiddenScroll(),e.initDialog(b),f.android&&e.initSearch(b),r.getBarHeight(function(a){f.asyncLoadInstance("widget/yellowTips",function(b){
b&&b.show&&b.show({top:a,biz_id:"comic_center"},p)})}),setTimeout(function(){a.async("imgReport",function(a){a&&a.init({id:1e4,subid:2,pageLoadTime:_timePoints[0]})})},1e3)},b.forbiddenScroll=function(){
f.asyncLoadInstance("business/jsbridge",function(a){a.invoke("mqq.ui.webviewCanScroll",{enable:!1})})},b.showLastReadBtn=function(){var a=this,c=arguments.callee,e=function(){a.getTodayFirstComic(function(a){
a&&(a.sectionName="第1话",a.pageID="",a.pageOffset=0,a.sectionIndex=0,a.showName="开始看"+r.getNewSectionShowName(a.name,"1话"),a.sectionIndex=0,d(".guide-bar").replaceWith(h.get(r.keepReedTpl,{data:a,showAnimate:!r.hasRenderLastReadBtn
},h.getInstance({action:b,string:i}))),r.hasRenderLastReadBtn=!0)})};c.bindVisible||(c.bindVisible=!0,f.bindPageVisibleEvent(function(b){b.hidden||a.showLastReadBtn()})),c.timeout&&0!=c.timeout&&clearTimeout(c.timeout),
c.timeout=setTimeout(function(){e()},8e3),f.asyncLoadInstance("business/comic",function(b){b.getReadInfo({},function(b){0!=c.timeout&&clearTimeout(c.timeout),a.renderLastReadBtn(b,e)})})},b.renderLastReadBtn=function(a,c){
arguments.callee;if(a&&0==a.result&&a.data&&a.data.id){var e=a.data,g=function(){e.showName="继续看"+r.getNewSectionShowName(e.name,e.sectionName),d(".guide-bar").replaceWith(h.get(r.keepReedTpl,{data:e,showAnimate:!r.hasRenderLastReadBtn
},h.getInstance({action:b,string:i}))),r.hasRenderLastReadBtn=!0};e.type?g():f.asyncLoadInstance("business/comic",function(a){a.getDetailInfo({idList:[e.id]},function(a){0==a.result&&a.data&&a.data[e.id]?(e.type=a.data[e.id].type,
g()):c()})})}else c()},b.clickKeepRead=function(a,b){var c=this,d=arguments.callee;if(!d.click&&(d.click=!0,b)){if(p.send({obj_id:"10039",oper_obj_type:"2",oper_obj_id:200220,ret_id:b.id,ext8:q}),c.checkBlack(b.id))return c.openComicWV("limit",{
_cwv:1,_wv:1027}),void(d.click=!1);b.from=e.params._cfrom||e.params.from||6,b.returnToDetail=f.compareVersion(f.QQVersion,"6.5.5")<0,b.oper_obj_id=200220,b.type>=100&&b.type<=300?f.asyncLoadInstance("business/video",function(a){
a.getIsVideoChat(function(){(!f.android||f.compareVersion(f.QQVersion,"5.9.5")<0)&&a.setVideoReadInfo(b,function(a){}),a.watch(b,function(a){setTimeout(function(){d.click=!1},1e3)})},function(){setTimeout(function(){
d.click=!1},1e3)})}):g.read(b,function(a){setTimeout(function(){d.click=!1},1e3),0!=a.result}),setTimeout(function(){d.click=!1},4e3)}},b.checkBlack=function(a){return!o&&"undefined"!=typeof m[a]},r.getNewSectionShowName=function(a,b){
var a=a.length>5?a.substring(a,5)+"...":a;return"《"+a+"》"+b},b.getTodayFirstComic=function(a){var b={id:"",name:""},c=d("#hot_recommend_wrap ul li").eq(0);c.length&&(b.id=c.data("id"),b.name=c.data("name"),
b.sectionID=c.data("section"),b.type=c.data("type"),a&&a(b))},b.showCommonList=function(a,b){var c,d=this,e={},g="";for(var h in b)if(b[h])if(g="newIndex_autoRecommend_Module_"+b[h],c=j.get(g))try{e[b[h]]=c.split(",");
}catch(i){e[b[h]]=[]}else e[b[h]]=[];a.mapList=e,d.getNewIndexCommonList(a,function(a){f.getNowTime(function(b){d.renderNewIndexCommonList(a,b)})})},b.saveMultiCache=function(a,b){a=a||[];var c=this;a.forEach(function(a){
if(a.isMulti>0){for(var d=a.id,e="newIndex_multi_ModuleIds_"+d,f=[],g=a.list||[],h=n["pageSize_"+d]||6,i=0,k=g.length;k>i;i++)g[i]&&f.push(g[i].id);if(b)n[d]=g.concat(),f.length&&j.set(e,f.join(","),"memory");else{
if(h=c.getPageSize(a.type)||Math.ceil(g.length/2),n["pageSize_"+d]=h,2==a.isMulti&&(n["totalPageNum_"+d]=Math.ceil(a.total/h)),f.length){var l=f.splice(h)||[];j.set(e,l.join(","),"memory")}var m=g.splice(h)||[];
setTimeout(function(){n[d]=m},50)}}})},b.clickMultiChange=function(a,b){var c=this,e=arguments.callee,g=d(a.currentTarget);if(g.addClass("active"),setTimeout(function(){g.removeClass("active")},300),p.send({
obj_id:"10041",oper_obj_type:"2",oper_obj_id:200424,ses_id:g.data("modname"),ret_id:b.name||"",algo_id:b.rule,ext3:g.data("position"),ext6:2,ext8:q}),b&&b.id){var k=b.id,l="newIndex_multi_ModuleIds_"+k,m=1e4;
if(Math.abs((new Date).getTime()-e["loadTime"+k])<m)return!1;e["loadTime"+k]=(new Date).getTime();var o=b.isMulti,s=(n["pageSize_"+k]||0,n["curPage_"+k]||3),t=(n["totalPageNum_"+k]||0,n[k]||[]);if(t.length){
b.list=t;var u=g.data("position"),v=h.get(r.getCommonListTpl(b.type),{algorithmList:b.algorithmList,moduleId:b.id,list:b.list,moduleName:b.name,moduleType:b.type,rule:b.rule,option:{gColdLaunch:q},position:u
},h.getInstance({newIndex:r.newIndex,string:i})),w=d("[data-mod-wrap='"+k+"']");w.replaceWith(v),setTimeout(function(){f.asyncLoadInstance("widget/img_loader",function(a){a.getInstance().compile(d("section[data-modid='"+k+"']"));
}),w=null},10)}var x={};x[k]=j.get(l,"memory").split(",")||[];var y=1==o?"getDisorderedMultiList":"getOrderedMultiList";!function(a){c[y]({mapList:x,page:s},function(b){e["priority"+k]==a&&(0==b.result?f.getNowTime(function(a){
c.renderNewIndexCommonList(b,a),n["curPage_"+k]=s+1,e["loadTime"+k]=0}):e["loadTime"+k]=0)})}(e["priority"+k]=(parseInt(e["priority"+k])||0)+1)}},b.getTypeClassName=function(a,b){var c="";switch(a){case 3:
c="mod-svip mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-trisect";break;case 2:case 4:case 5:case 13:case 16:case 17:c="mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-trisect";
break;case 6:case 7:case 8:case 9:c="mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-bisect";break;case 10:case 23:c="mod-kbn mt10 ui-panel ui-panel-center"+(b?"-multi":"");break;case 11:
c="mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-bisect mod-daily-journal";break;case 12:c="mod-tm mt10 ui-panel ui-panel-center"+(b?"-multi":"");break;case 18:c="mod-album mt10 ui-panel ui-panel-center"+(b?"-multi":"");
break;case 19:c="mod-sort mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-trisect";break;case 20:c="mod-studio mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-trisect";
break;case 21:c="mod-ad mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-trisect";break;case 14:default:c="mt10 ui-panel ui-panel-center"+(b?"-multi":"")+" ui-grid ui-grid-bisect"}return c;
},b.renderNewIndexCommonList=function(a,c){var e=this,g=arguments.callee;if(a&&0==a.result&&a.data&&a.data.length){for(var k=a.data,l=0;l<k.length;l++){if(k[l].typeClassName=e.getTypeClassName(k[l].type,k[l].desc),
k[l].algorithmList){var m=k[l].algorithmList.sort(function(a,b){return a.iAlgorithmType>b.iAlgorithmType});k[l].algorithmList=m}if(e.needShowType(k[l].type)&&k[l].list.length)for(var n=0;n<k[l].list.length;n++)if(k[l].list[n]){
if(k[l].list[n].tags&&k[l].list[n].tags.length){for(var o=[],p=0;p<k[l].list[n].tags.length;p++)k[l].list[n].tags[p]&&o.push("<li>"+k[l].list[n].tags[p]+"</li>");k[l].list[n].tagDesc=o.join("")}1==k[l].list[n].showType?k[l].list[n].readDesc=e.getReadDesc(k[l].list[n].readPicCount):2==k[l].list[n].showType?k[l].list[n].readDesc=e.getLimitReadDesc(k[l].list[n],c):3==k[l].list[n].showType?k[l].list[n].readDesc=e.getUpdateReadDesc(k[l].list[n],c):k[l].list[n].readDesc="";
}var s=k[l]||{};if(e.isAutoRecommendType(s.type)&&s.list.length&&!g.loading){var t="newIndex_autoRecommend_Module_"+s.id,u=[],v=s.list.length;s.isMulti>0&&(v=e.getPageSize(s.type),s.total>0&&s.total<=2*v&&(s.list=s.list.slice(0,v),
s.isMulti=0));for(var n=0;v>n;n++)s.list[n]&&u.push(s.list[n].id);u.length&&j.set(t,u.join(","))}}var w=!!g.loading;if(e.saveMultiCache(k,w),g.loading)return;g.loading=!0,d("#index_wrap").append(h.get(r.commonListTpl,{
list:k,priv:r,tpl:h,string:i,newIndex:r.newIndex,option:{gColdLaunch:q}},h.getInstance({action:b,newIndex:r.newIndex,string:i}))),d("#index_all_wrap").append(h.get("end_notice_Tpl",{})),f.asyncLoadInstance("lib/swiper",function(){
e.initModuleAnimation(),setTimeout(function(){f.asyncLoadInstance("widget/img_loader",function(a){a.getInstance().compile(d("#index_wrap"))})},10)})}window._timePoints[13]||(window._timePoints[13]=Date.now(),
f.markQtaPageShowed())},b.initModuleAnimation=function(){var a;["ad","studio","sort"].forEach(function(b){var c=".mod-"+b+">.swiper-container",e=d(c);e.length&&(a={slidesPerView:"auto"},"studio"===b&&e.find("li").length>2&&(a.centeredSlides=!0,
a.loop=!0),new Swiper(c,a))});var b=j.get("indexKanbanClicked");if(!b){var c=d(".mod-kbn").eq(0),e=d(".mod-kbn .kbn-list li").eq(1);if(c.length){var f=d(window),g=e.offset().top,h=e.height(),i=f.height(),k=r._throttle(function(){
var a=d(window).scrollTop();a>g+h||g-i>a||(d(".mod-kbn .bubble").addClass("show"),f.off("scroll",k))});f.on("scroll",k)}}},r._throttle=function(a,b){var c,d=a,e=!0;return function(){var a=arguments,f=this;
return e?(d.apply(f,a),e=!1):c?!1:void(c=setTimeout(function(){clearTimeout(c),c=null,d.apply(f,a)},b||300))}},b.getReadDesc=function(a){return r.newIndex.getReadDesc(a)},b.getUpdateReadDesc=function(a,b){
var c,d,e,f,g="",h=new Date(b);return c=h.getHours(),d=h.getMinutes(),b/=1e3,e=Math.abs((a.updateTime-b)/60),f=60*c+d,e-=f,g=0>e?"今天更新":e/1440>=7?"一周前更新":Math.ceil(e/1440)+"天前更新"},b.getLimitReadDesc=function(a,b){
var c,d="";return b/=1e3,a.limitTimeStart>b?(c=a.limitTimeStart-b,c>0&&3600>c&&(d=(60>c?1:Math.floor(c/60))+"分钟后开启"),c>=3600&&86400>c&&(d=""+Math.floor(c/3600)+"小时后开启"),c>=86400&&(d=Math.floor(c/86400)+"天后开启")):a.limitTimeEnd<b?d="已过期":(c=a.limitTimeEnd-b,
c>0&&3600>c&&(d="剩余"+(60>c?1:Math.floor(c/60))+"分钟"),c>=3600&&86400>c&&(d="剩余"+Math.floor(c/3600)+"小时"),c>=86400&&(d="剩余"+Math.floor(c/86400)+"天")),d},r.getBarHeight=function(a){if(f.android){var b=parseInt(j.get("vip_comic_client_height"));
!isNaN(b)&&b>0?a(b):f.getTitleBarHeight(function(b){var c=Math.floor((0==b.code?b.data.height:50)/window.devicePixelRatio);a(c),j.set("vip_comic_client_height",c)})}else a(64)},b.initDialog=function(a){
var b=(arguments.callee,this);f.asyncLoadInstance("business/dialogMediator",function(c){if(c){var d={self:b,params:a,compassReport:p,getSlipInstance:r.getSlipInstance};r.mediator=c,c.pub("addDialog",{name:"actPoint",
module:"",url:"business/newActPoint",hasShow:!1,params:d}),c.pub("initDialogQueue",a)}})},r.getSlipInstance=function(b){var c=arguments.callee;c.error||(c.error=0),c.error>=10||(c.slip?b&&b(c.slip):a.async("lib/slip",function(a){
a?(c.slip=a,b(c.slip)):(c.error++,c.call(c,b))}))},b.initSearch=function(a){f.android&&f.asyncLoadInstance("business/jsbridge",function(a){a.invoke("mqq.ui.setTitleButtons",{right:{title:"",iconID:6,callback:function(){
var a=e.createUrl("search",{pos:"3039",_wv:1027,type:"index"});f.openCommonUrl(a)}}})})}});