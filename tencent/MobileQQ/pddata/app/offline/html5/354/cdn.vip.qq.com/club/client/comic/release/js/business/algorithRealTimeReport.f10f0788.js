define("business/algorithRealTimeReport",["business/common","zepto","business/router","piggy/util/cookie","business/jsbridge","piggy/util/cacheData","piggy/util/tpl","piggy/util/uri","piggy/util/report","piggy/util/process","business/report","piggy/util/net","lib/zepto"],function(a,b,c){
var d,e=a("business/common"),f=a("business/router"),g=a("business/report").baseData,h={},i=null,j=e.getPrivateToken(),k=f.getUserId(),l=a("lib/zepto"),m={},n={},o={data_type:2,bid:"b_teg_openrecom_gdi4ar4ndazhhkj0l7d5",
uid_type:0,uid:k,imei:"",device:"",app_version:"",platform:"",report_source:3,network_type:"unknow",busi_id:100332,trace_id:Date.now()+j+k};h.send=function(a,b,c){var d=l.extend({},o,b),g={shareData:d,
dataList:a};c&&(g.appType=Number(c));var h={reportAction:{module:"comic_comm_recommend_mt_svr",method:"reportRealTimeData",param:g}};e.sendRequest({url:f.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),
type:"POST",data:{param:JSON.stringify(h)},callback:function(a){}})},h.mergeSend=function(){for(var a in m){var b=JSON.parse(JSON.stringify(m[a]));m[a]=[];var c="b_teg_openrecom_r9v5cvkgnt6dtvungfba"==n[a].bid?2:null;
b.length>0&&h.send(b,n[a],c)}d=null},b.send=function(a,b,c){var e=1,k=1;e=a.scene_id?a.scene_id:e,k=a.test_id?a.test_id:k;var l=Date.now()+Number(Number(1e4*Math.random()).toFixed(0));n[e+""+k]||(n[e+""+k]={
scene_id:e+"",source:"SNG_COMIC_"+(a.source?a.source:0),page_id:a.page_id,MD5:"b_teg_openrecom_gdi4ar4ndazhhkj0l7d5"+l+j,request_id:l,action_type:1,action_time:Date.now()+""}),a.bid&&(o.bid=a.bid);var p={
item_id:a.item_id+"",trace_sng_id:a.sng_trace_id+"",test_id:Number(k),rule_id:Number(a.algo_id)||0,action_value:"",item_type:(c?c:1)+"",sub_item_id:a.sub_item_id||"",module_id:"3039"==a.page_id||"3040"==a.page_id?Number(a.ext5):null,
sub_module_id:a.sub_module_id||-1,position_id:Number(a.ext4)||-1,mapExtend:a.mapExtend||{}},q=f.resourceIdConfig;if(a.resource_name&&q[a.resource_name]){var r=q[a.resource_name];/98765$/.test(r)&&(r+=a.resource_id||("3039"==a.page_id||"3040"==a.page_id?Number(a.ext5):"")),
p.module_id=parseInt(r)||0}else a.module_id&&(p.module_id=parseInt(a.module_id));if(""===g.domain_ver||i||(i=!0,o.device=g.device_type,o.app_version=g.mqq_ver,o.platform=g.domain),"unknow"!==g.net_type&&(o.network_type=g.net_type),
""!==g.imei&&""===o.imei&&(o.imei=g.imei),1===b)m[e+""+k]||(m[e+""+k]=[]),m[e+""+k].push(p),d||(d=setTimeout(function(){h.mergeSend()},500));else{var s="b_teg_openrecom_r9v5cvkgnt6dtvungfba"==a.bid?2:null;
h.send([p],{scene_id:e+"",source:"SNG_COMIC_"+(a.source?a.source:0),page_id:a.page_id,MD5:"b_teg_openrecom_gdi4ar4ndazhhkj0l7d5"+l+j,request_id:l,action_type:b,action_time:Date.now()+""},s)}},b.getRealTimeParam=function(){
var a=f.params,b="test_id="+(a.test_id||1)+"&rule_id="+(a.rule_id||a.algo_id||1);b=b+"&trace_id="+Date.now()+j+k,b=b+"&source=SNG_COMIC_"+(a.source||0),b=b+"&network="+g.net_type,b=b+"&device="+g.device_type,
b=b+"&app_version="+g.mqq_ver,b=b+"&platform="+g.domain;var c=f.getSubParam("read_params","is_new_24");return c&&(b=b+"&module_id="+c),b}});