define("widget/yellowTips",["lib/zepto","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","business/common","piggy/util/cacheData","piggy/util/tpl","piggy/util/report","piggy/util/string"],function(a,b,c){
var d=a("lib/zepto"),e=a("business/router"),f=a("business/common"),g=a("piggy/util/cacheData"),h=a("piggy/util/tpl"),i=a("business/jsbridge"),j=a("piggy/util/string"),k={},l='<div class="ui-tooltips ui-tooltips-warn ui-tooltips-hignlight" style="top:<%=top%>px" onclick="<%=this.getInvoke(\'action.clickYellowTips\', data)%>"><div class="ui-tooltips-cnt ui-tooltips-cnt-link"><i></i><%=this.getData("string.encodeHTML", data.text)%></div></div>';
b.show=function(a,c,f){var i=this,m=parseInt((new Date).getTime()/1e3);if(a.biz_id){k.bid_id=a.biz_id,k.report=c||null,a.tpl&&(l=a.tpl),k.key="yellow_tips_"+k.bid_id+"_"+e.getUserId();var n=function(){
i.getYellowTipsInfo(k.bid_id,function(c){if(c&&0==c.result&&c.data&&c.data.info&&c.data.info.endTime){var e=c.data.info,f=!1;e.clickToDisappear&&(f=g.get(k.key+"_click_"+e.id)),f||(g.set(k.key+"_lastTime",""),
d("body").prepend(h.get(l,{data:e,top:a.top||0},h.getInstance({action:b,string:j}))),k.report&&k.report.send({oper_obj_type:"3",oper_obj_id:300005,oper_id:"10033",ext2:e.clickToDisappear?1:2}))}else g.set(k.key+"_lastTime",parseInt((new Date).getTime()/1e3));
})},o=g.get(k.key+"_lastTime");(!o||m-o>60)&&n()}},b.getYellowTipsInfo=function(a,b){var c={biz_id:a,uin:parseInt(e.getUserId())};f.sendMergeRequest({url:e.createNewUrl("vp/cgi-bin/interact_asyn_cgi"),
data:{module:"emergency_information_mt_svr",method:"GetEmergencyInformation",param:c},callback:function(a){b(a)}})},b.clickYellowTips=function(a,b){a.originalEvent.stopPropagation(),k.report&&k.report.send({
oper_obj_type:"2",oper_obj_id:200215,oper_id:"10033"}),b&&(b.clickToDisappear&&(g.set(k.key+"_click_"+b.id,1),d(a.currentTarget).hide()),b.url&&i.invoke("mqq.ui.openUrl",{url:b.url,target:1}))}});