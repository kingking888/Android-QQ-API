define("business/newActPoint",["lib/zepto","piggy/util/tpl","piggy/util/net","business/common","zepto","business/router","piggy/util/cookie","business/jsbridge","piggy/util/cacheData","piggy/util/uri","piggy/util/report","piggy/util/process","business/security","business/dialogMediator"],function(a,b,c){
var d=a("lib/zepto"),e=a("piggy/util/tpl"),f=a("piggy/util/net"),g=a("business/common"),h=a("business/router"),i=a("piggy/util/cacheData"),j=a("business/security"),k=a("business/jsbridge"),l=a("business/dialogMediator"),m="3039",n={},o=1e4,p={
shouldDisplay:!1},q=window.location.protocol+"//h5.vip.qq.com/p/red/cgi-bin/srfentry.fcgi";n.path=(g.iOS,"100800"),b.state=p,n.cssText='.ui-dialog-ft,.ui-dialog-ft button:first-child{border-bottom-left-radius:6px}.act-slider-content>li.active,.ui-dialog-close.active{opacity:.5}.action-link,.ui-dialog-bd>h4,.ui-dialog-ft button,.ui-dialog-hd{text-align:center}.theme-blue a{color:#00a5e0}.theme-blue .ui-btn,.theme-blue .ui-btn-lg,.theme-blue .ui-btn-s{color:#00a5e0;border-color:#37c3f7;background:#fff}.theme-blue .ui-btn-lg.active,.theme-blue .ui-btn-lg:not(.disabled):not(:disabled):active,.theme-blue .ui-btn-s.active,.theme-blue .ui-btn-s:not(.disabled):not(:disabled):active,.theme-blue .ui-btn.active,.theme-blue .ui-btn:not(.disabled):not(:disabled):active{color:rgba(0,165,224,.5);border-color:rgba(55,195,247,.5);background:#fff}.theme-blue .ui-btn-primary{color:#fff;border-color:#00c5f8;background:#00c5f8}.theme-blue .ui-btn-primary.active,.theme-blue .ui-btn-primary:not(.disabled):not(:disabled):active{color:rgba(255,255,255,.5);border-color:#00b3e2;background:#00b3e2}.theme-blue .ui-btn-danger{color:#fff;border-color:#f43d30;background:#f75549}.theme-blue .ui-btn-danger.active,.theme-blue .ui-btn-danger:not(.disabled):not(:disabled):active{color:rgba(255,255,255,.5);border-color:#e2574d;background:#e2574d}.ui-dialog{position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:none}.ui-dialog.show{display:-webkit-box;display:box}.ui-dialog-hd{height:48px;line-height:48px;position:relative}.ui-dialog-cnt{border-radius:6px;width:270px;-webkit-background-clip:padding-box;background-clip:padding-box;pointer-events:auto;background-color:rgba(253,253,253,.95);position:relative;font-size:16px}.ui-dialog-bd{min-height:71px;border-top-left-radius:6px;border-top-right-radius:6px;padding:18px;display:-webkit-box;display:box;-webkit-box-pack:center;-webkit-box-align:center;-webkit-box-orient:vertical}.ui-dialog-bd>h4{margin-bottom:4px;width:100%}.ui-dialog-bd>div,.ui-dialog-bd>ul{width:100%}.ui-dialog-ft{border-bottom-right-radius:6px;display:-webkit-box;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-align:center;border-top:1px solid #e9e9e9;height:42px;line-height:42px}.ui-dialog-close:before{font-family:iconfont!important;font-size:32px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;content:"";color:#828282;display:block;line-height:32px;position:absolute;top:3px;right:3px}.ui-dialog-ft button{color:#00a5e0;border-right:1px #e9e9e9 solid;width:100%;line-height:42px;background:0 0;display:block;margin:0!important;-webkit-box-flex:1}.ui-dialog-ft button:active{background-color:rgba(0,0,0,.1)!important}.ui-dialog-ft button:last-child{border-right:0;border-bottom-right-radius:6px}@media screen and (-webkit-min-device-pixel-ratio:2){.ui-dialog-ft{position:relative;border:0;background-position:left top;background-image:-webkit-gradient(linear,left bottom,left top,color-stop(.5,transparent),color-stop(.5,#e9e9e9));background-repeat:repeat-x;-webkit-background-size:100% 1px}.ui-dialog-ft button{border-right:0;background-position:right top;background-image:-webkit-gradient(linear,left top,right top,color-stop(.5,transparent),color-stop(.5,#e9e9e9));background-repeat:repeat-y;-webkit-background-size:1px 100%}.ui-dialog-ft button:last-child{background:0 0}}.ui-btn,.ui-btn-lg,.ui-btn-s{position:relative;text-align:center;background-color:#fff;vertical-align:top;color:#534129;-webkit-box-sizing:border-box;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #cacccd;border-radius:4px}.ui-btn-lg.active,.ui-btn-lg:not(.disabled):not(:disabled):active,.ui-btn-s.active,.ui-btn-s:not(.disabled):not(:disabled):active,.ui-btn.active,.ui-btn:not(.disabled):not(:disabled):active{color:rgba(83,65,41,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-lg:after,.ui-btn-s:after,.ui-btn:after{content:"";position:absolute;top:-7px;bottom:-7px;left:0;right:0}.ui-btn-lg.disabled,.ui-btn-lg:disabled,.ui-btn-s.disabled,.ui-btn-s:disabled,.ui-btn.disabled,.ui-btn:disabled{border-color:#e7e7e7;color:#bbb;background:#e7e7e7;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-s{width:auto;height:25px;line-height:25px;font-size:13px;padding:0 10px;border-radius:3px}.ui-btn{height:30px;line-height:30px;padding:0 11px;min-width:56px;display:inline-block;font-size:15px}.ui-btn-lg{font-size:17px;height:44px;line-height:44px;display:block;width:100%;border-radius:6px}.ui-btn-primary{background-color:#fabe07;border-color:#fabe07;color:#534129;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-primary.active,.ui-btn-primary:not(.disabled):not(:disabled):active{background:#e7be0b;border-color:#e7be0b;color:rgba(83,65,41,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-danger{background-color:#f75549;color:#fff;border-color:#f43d30;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-danger.active,.ui-btn-danger:not(.disabled):not(:disabled):active{background:#e2574d;border-color:#e2574d;color:rgba(255,255,255,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-wrap{padding:15px 10px}@media (max-width:320px){.ui-btn-wrap{padding:10px}}.dialog-guide{width:100%;margin-top:20px}.ui-dialog{background:rgba(0,0,0,.8)}.act-slider{width:100%;position:relative;overflow:hidden;margin:auto;padding-bottom:30px}.act-slider-content{display:-webkit-box;position:absolute;left:0;top:0;height:100%}.act-slider-content>li{-webkit-box-flex:1;width:100%;height:100%;overflow:hidden}.act-slider-content>li img{display:block;width:100%}.act-slider-indicators{position:absolute;display:-webkit-box;width:100%;bottom:13px;font-size:0;-webkit-box-pack:center;right:0}.act-slider-indicators li{display:block;text-indent:100%;white-space:nowrap;overflow:hidden;font-size:0;width:7px;height:7px;background-color:rgba(255,255,255,.2);border-radius:10px;margin-right:6px;-webkit-box-sizing:border-box;-webkit-background-clip:padding-box;position:relative}.act-slider-indicators li.current{height:8px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQBAMAAADUulMJAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAYUExURQAAAP///////////////////////////yN+nV8AAAAHdFJOUwA56MRcEYRLMPqPAAAAVElEQVQI12NggAHW5HKzACAtVF5ersLAwFgOAgIMTOWC5eXFAQzuIDqBgcEcKFoCVKZeXl4kAKShXBC/3JABIl+eygBUDwRFDkD9IKAKNw9mPtQ+APatHiUBiOvIAAAAAElFTkSuQmCC);-webkit-background-size:7px 8px;background-size:7px 8px}.dialog-guide .ui-btn-wrap{padding:10px 40px}',
n.snapshot_guide_cssText='.ui-dialog-ft,.ui-dialog-ft button:first-child{border-bottom-left-radius:6px}.theme-blue a{color:#00a5e0}.theme-blue .ui-btn,.theme-blue .ui-btn-lg,.theme-blue .ui-btn-s{color:#00a5e0;border-color:#37c3f7;background:#fff}.theme-blue .ui-btn-lg.active,.theme-blue .ui-btn-lg:not(.disabled):not(:disabled):active,.theme-blue .ui-btn-s.active,.theme-blue .ui-btn-s:not(.disabled):not(:disabled):active,.theme-blue .ui-btn.active,.theme-blue .ui-btn:not(.disabled):not(:disabled):active{color:rgba(0,165,224,.5);border-color:rgba(55,195,247,.5);background:#fff}.theme-blue .ui-btn-primary{color:#fff;border-color:#00c5f8;background:#00c5f8}.theme-blue .ui-btn-primary.active,.theme-blue .ui-btn-primary:not(.disabled):not(:disabled):active{color:rgba(255,255,255,.5);border-color:#00b3e2;background:#00b3e2}.theme-blue .ui-btn-danger{color:#fff;border-color:#f43d30;background:#f75549}.theme-blue .ui-btn-danger.active,.theme-blue .ui-btn-danger:not(.disabled):not(:disabled):active{color:rgba(255,255,255,.5);border-color:#e2574d;background:#e2574d}.theme-blue .ui-btn.disabled,.theme-blue .ui-btn:disabled{border-color:#e7e7e7;color:#bbb;background:#e7e7e7;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-dialog{position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:none}.ui-dialog.show{display:-webkit-box;display:box}.ui-dialog-hd{height:48px;line-height:48px;text-align:center;position:relative}.ui-dialog-cnt{border-radius:6px;width:270px;-webkit-background-clip:padding-box;background-clip:padding-box;pointer-events:auto;background-color:rgba(253,253,253,.95);position:relative;font-size:16px}.ui-dialog-bd{min-height:71px;border-top-left-radius:6px;border-top-right-radius:6px;padding:18px;display:-webkit-box;display:box;-webkit-box-pack:center;-webkit-box-align:center;-webkit-box-orient:vertical}.ui-dialog-bd>h4{margin-bottom:4px;width:100%;text-align:center}.ui-dialog-bd>div,.ui-dialog-bd>ul{width:100%}.ui-dialog-ft{border-bottom-right-radius:6px;display:-webkit-box;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-align:center;border-top:1px solid #e9e9e9;height:42px;line-height:42px}.ui-dialog-close:before{font-family:iconfont!important;font-size:32px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;content:"";color:#828282;display:block;line-height:32px;position:absolute;top:3px;right:3px}.ui-dialog-close.active{opacity:.5}.ui-dialog-ft button{color:#00a5e0;text-align:center;border-right:1px #e9e9e9 solid;width:100%;line-height:42px;background:0 0;display:block;margin:0!important;-webkit-box-flex:1}.ui-dialog-ft button:active{background-color:rgba(0,0,0,.1)!important}.ui-dialog-ft button:last-child{border-right:0;border-bottom-right-radius:6px}@media screen and (-webkit-min-device-pixel-ratio:2){.ui-dialog-ft{position:relative;border:0;background-position:left top;background-image:-webkit-gradient(linear,left bottom,left top,color-stop(.5,transparent),color-stop(.5,#e9e9e9));background-repeat:repeat-x;-webkit-background-size:100% 1px}.ui-dialog-ft button{border-right:0;background-position:right top;background-image:-webkit-gradient(linear,left top,right top,color-stop(.5,transparent),color-stop(.5,#e9e9e9));background-repeat:repeat-y;-webkit-background-size:1px 100%}.ui-dialog-ft button:last-child{background:0 0}}.ui-btn,.ui-btn-lg,.ui-btn-s{position:relative;text-align:center;background-color:#fff;vertical-align:top;color:#534129;-webkit-box-sizing:border-box;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #cacccd;border-radius:4px}.ui-btn-lg.active,.ui-btn-lg:not(.disabled):not(:disabled):active,.ui-btn-s.active,.ui-btn-s:not(.disabled):not(:disabled):active,.ui-btn.active,.ui-btn:not(.disabled):not(:disabled):active{color:rgba(83,65,41,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-lg:after,.ui-btn-s:after,.ui-btn:after{content:"";position:absolute;top:-7px;bottom:-7px;left:0;right:0}.ui-btn-lg.disabled,.ui-btn-lg:disabled,.ui-btn-s.disabled,.ui-btn-s:disabled,.ui-btn.disabled,.ui-btn:disabled{border-color:#e7e7e7;color:#bbb;background:#e7e7e7;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-s{width:auto;height:25px;line-height:25px;font-size:13px;padding:0 10px;border-radius:3px}.ui-btn{height:30px;line-height:30px;padding:0 11px;min-width:56px;display:inline-block;font-size:15px}.guide-img,.guide-img span,.ui-btn-lg{display:block;width:100%}.ui-btn-lg{font-size:17px;height:44px;line-height:44px;border-radius:6px}.ui-btn-primary{background-color:#fabe07;border-color:#fabe07;color:#534129;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-primary.active,.ui-btn-primary:not(.disabled):not(:disabled):active{background:#e7be0b;border-color:#e7be0b;color:rgba(83,65,41,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-danger{background-color:#f75549;color:#fff;border-color:#f43d30;-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-danger.active,.ui-btn-danger:not(.disabled):not(:disabled):active{background:#e2574d;border-color:#e2574d;color:rgba(255,255,255,.5);-webkit-background-clip:padding-box;background-clip:padding-box}.ui-btn-wrap{padding:15px 10px}@media (max-width:320px){.ui-btn-wrap{padding:10px}}.dialog-guide{width:100%;margin-top:30px}.ui-dialog{background:rgba(0,0,0,.7)}.guide-img{margin:auto;position:relative}.guide-img span{position:absolute;left:0;top:0;height:100%;-webkit-background-size:100% auto;background-size:100% auto;background-repeat:no-repeat}.dialog-guide .ui-btn-wrap{padding:20px 0}.guide-btn{width:168px;margin:auto}',
n.snapshot_guide_tpl='<section id="snapshot_guide" class="ui-dialog show">		<div class="dialog-guide">			<div class="guide-img"><span style="background-image: url(../img/index/snapshot_guide.png?max_age=31536000)"></span></div>			<div class="ui-btn-wrap guide-btn"><button class="ui-btn-lg ui-btn-primary" onclick="<%=this.getInvoke(\'action.clickCloseSnaphostGuide\')%>">知道了</button></div>		</div>	</section>',
n.reddialog_tpl='<div id="red_dialog_wrap" class="ui-dialog ui-dialog-operate dialog-rank show">            <div class="ui-dialog-cnt">                <div class="ui-dialog-hd" style="margin-top: 35px">                    <div class="ui-img">                        <span onclick="<%=this.getInvoke(\'action.clickOpenRedDialogLink\', data)%>" style="background-image:url(<%=data.img%>)"></span>                    </div>                </div>            <i class="ui-dialog-close" data-role="button" onclick="<%=this.getInvoke(\'action.clickCloseRedDialogGuide\', data)%>"></i>            </div>        </div>',
n.setLocalStorage=function(a,b){i.set(h.getUserId()+"comic_act_point_"+a,b)},n.getLocalStorage=function(a){return i.get(h.getUserId()+"comic_act_point_"+a)},n.stopDlgScroll=function(){return!1},n.loadImage=function(a,b){
if(Array.isArray(a)){var c,d,e=a.length,f=e;for(c=0;f>c;c++)d=new Image,d.src=a[c].img,0===c&&(d.onload=function(){b&&b(a)})}},n.indexActTpl='<section id="actPointWrap" class="ui-dialog"><div class="dialog-guide"><div class="act-slider"><ul class="act-slider-content" style="width:<%=(list.length * 100)%>%"><%for(var i = 0, max = list.length, data; data = list[i], i < max; i++){%><li><img src="<%=data.img%>"></li><%}%></ul><ul class="act-slider-indicators" style="display: none;"><%for(var i = 0, max = list.length;i < max; i++){%><li <%if(i == 0){%>class="current"<%}%>><%=(i + 1)%></li><%}%></ul></div><div class="ui-btn-wrap"><button onclick="<%=this.getInvoke(\'action.clickGotoComic\')%>" class="ui-btn-lg ui-btn-primary">好！我去看看 (ﾉﾟ▽ﾟ)ﾉ</button></div><p class="action-link"><a href="javascript:;" onclick="<%=this.getInvoke(\'action.clickCloseTips\')%>">先去首页逛逛</a></p></div></section>',
n.loadMask=function(a){var c=arguments.callee;if(0===d("#index_act_style").length){if(!p.shouldDisplay)return;n.setLocalStorage("show","1"),d("head").append('<style id="index_act_style">'+n.cssText+"</style>"),
d("#act_point_wrap").replaceWith(e.get(n.indexActTpl,{list:a},e.getInstance({action:b}))).show();var f,g=375/310,h=document.documentElement.clientWidth,i=document.documentElement.clientHeight-64-60-88-20,j=h/i;
f=j>g?(i/310).toString().substring(0,6):(h/375).toString().substring(0,6),d("#actPointWrap .act-slider").width(375*f+"px").css("padding-top",310*f+"px"),d("#actPointWrap").addClass("show"),n.curComicId=a[0].id,
n.curBannerId=0,n.initSlider(a),n.isActPointShow=!0,c.bindScroll||(c.bindScroll=!0,d("body").on("touchmove",function(a){n.isActPointShow&&a.preventDefault()})),n.compassReport.send({oper_obj_type:"1",oper_obj_id:10055
})}},n.initSlider=function(a){function b(){arguments.callee;n.getSlipInstance(function(b){var e=d(".act-slider-content"),f=a.length;c.actPointSlip=b("page",e.get(0),{change_time:5e3,num:f,wide_high:e.width()/f,
parent_wide_high:e.width()/f,touchEndFun:function(){},endFun:function(){var b=this,c=b.page;n.curComicId=a[c].id,n.curBannerId=c,n.compassReport.send({oper_obj_type:"2",oper_obj_id:20147,ret_id:n.curComicId,
ext2:n.curBannerId}),setTimeout(function(){d(".act-slider-indicators").find("li").removeClass("current").eq(c).addClass("current")},100)}}),c.actPointSlip.toPage(0),c.actPointSlip.stopChange(),c.actPointSlip.startChange();
}),d(".act-slider-indicators").show()}var c=this;setTimeout(function(){b()},1e3)},b.clickGotoComic=function(a){var b=arguments.callee,c=n.curComicId,e=n.curBannerId;b.click||(b.click=!0,n.isActPointShow=!1,
d("#actPointWrap").remove(),g.sendMergeRequest({url:h.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"comic_gzh_follow_mt_svr",method:"followSubcribe",param:{}},callback:function(a){}}),
n.compassReport.send({oper_obj_type:"2",oper_obj_id:20131,ret_id:c,ext2:e}),g.openComicDetail(h.createUrl("detail",{id:c,_bid:354,_cwv:1,pos:m})),setTimeout(function(){b.click=!1},1500))},b.clickCloseTips=function(a){
n.isActPointShow=!1,d("#actPointWrap").remove(),n.compassReport.send({oper_obj_type:"2",oper_obj_id:20132})},b.checkState=function(){var a=this;n.getLocalStorage("show")?a.showPicGuide():n.showRedDialog();
},n.initNextDialog=function(){l&&l.pub&&l.pub("cancelShowDialog")},n.getRedpointInstance=function(b){var c=arguments.callee;c.redpoint?b(c.redpoint):a.async("widget/redpoint",function(a){a&&a.queryDyanmicStatus&&(c.redpoint=a,
b(c.redpoint))})},n.forbidScroll=function(a){return a.preventDefault(),!1},n.showGuideTpl='<section class="ui-dialog show"><div class="dialog-guide"><span class="img" style="background-image:url(../img/index/dialog_guide.png?max_age=31536000)"></span><div class="guide-btn"><button class="ui-btn-lg ui-btn-primary" onclick="<%=this.getInvoke(\'action.openComicEnter\')%>">添加动态</button></div><p><a onclick="<%=this.getInvoke(\'action.closeGuide\')%>">残忍拒绝</a></p></div></section><section class="ui-dialog"><div class="dialog-guide-result"><span class="img"  style="background-image:url(../img/index/dialog_guide2.png?max_age=31536000)"></span></div></section>',
b.showGuide=function(){for(var a=(arguments.callee,"289348439,19538230,16450177,42550495,435632477,449662005,5514514,2458233610,616757290,398782833,421798919,993193320,1033511337,88620280"),c=a.split(","),f=h.getUserId(),j=0;j<c.length;j++)if(f==c[j])return;
n.compassReport.send({oper_obj_type:"2",oper_obj_id:20030});var k,l=(document,1),m=document.documentElement.clientWidth,o=document.documentElement.clientHeight-55-64-60,p=m/o;k=p>l?(o/320).toString().substring(0,6):(m/320).toString().substring(0,6);
var q=new Image,r=new Image;q.onload=function(){d("body").append(e.get(n.showGuideTpl,{},e.getInstance({action:b}))),d(".dialog-guide .img").width(320*k+"px").height(320*k+"px"),d(".ui-dialog").on("touchmove",n.forbidScroll),
i.set(h.getUserId()+"comic_index_guide",g.getDateStr())},q.src=window.location.protocol+"//cdn.vip.qq.com/club/client/comic/release/img/index/dialog_guide.png?max_age=31536000",r.src=window.location.protocol+"//cdn.vip.qq.com/club/client/comic/release/img/index/dialog_guide2.png?max_age=31536000";
},b.openComicEnter=function(){d(".ui-dialog").eq(0).removeClass("show"),d(".ui-dialog").eq(1).addClass("show fadeIn"),d(".ui-dialog").off("touchmove",n.forbidScroll),setTimeout(function(){d(".ui-dialog").remove(),
n.initNextDialog()},3e3),n.getRedpointInstance(function(a){a.setDynamic({path:a.path.dynamic.id,type:1},function(a){a&&0==a.result&&n.compassReport.send({oper_obj_type:"2",oper_obj_id:20031})})})},b.closeGuide=function(){
d(".ui-dialog").off("touchmove",n.forbidScroll),n.compassReport.send({oper_obj_type:"2",oper_obj_id:20029}),d(".ui-dialog").remove(),g.mediator.publish("actPointClose"),n.initNextDialog()},n.popBackShowGuideHandler=function(){
var a;try{i.get(h.getUserId()+"comic_index_guide")==g.getDateStr()?k.invoke("mqq.ui.popBack",{}):(a=g.mediator.subscribe("actPointClose",function(){a.remove(),k.invoke("mqq.ui.popBack",{})}),b.showGuide());
}catch(c){throw k.invoke("mqq.ui.popBack",{}),c}},b.showPicGuide=function(){if(n.params&&"pic"==n.params.extUrlParam){if(i.get(h.getUserId()+"comic_pic_guide"))return void n.initNextDialog();i.set(h.getUserId()+"comic_pic_guide","true"),
d("head").append('<style id="index_snapshot_guide_style">'+n.snapshot_guide_cssText+"</style>"),d("body").append(e.get(n.snapshot_guide_tpl,{},e.getInstance({action:b})));var a,c=375/490,f=document.documentElement.clientWidth,g=document.documentElement.clientHeight-64-55-60,j=f/g;
a=j>c?(g/490).toString().substring(0,6):(f/375).toString().substring(0,6),d("#snapshot_guide .guide-img").width(375*a+"px").css("padding-top",490*a+"px"),d("#snapshot_guide").on("touchmove",n.stopDlgScroll);
}},b.clickCloseSnaphostGuide=function(){d("#snapshot_guide").off("touchmove",n.stopDlgScroll),d("#snapshot_guide").remove(),n.initNextDialog()},n.renderRedDialog=function(a,c){var f,g=arguments.callee;if(g.count>0)return void n.initNextDialog();
"undefined"==typeof g.count&&(g.count=0),g.count++,f=a&&i.get(h.getUserId()+"index_reddialog_displayed_"+a.id),a&&"displayed"!=f&&i.set(h.getUserId()+"index_reddialog_displayed_"+a.id,1),a.isRed=c;var j=new Image;
j.onload=function(){d("#index_wrap").append(e.get(n.reddialog_tpl,{data:a},e.getInstance({action:b}))),d(".ui-dialog").on("touchmove",n.forbidScroll),n.compassReport&&n.compassReport.send({obj_id:"10081",
oper_obj_type:"3",oper_obj_id:300041,ret_id:a.id||0})},j.src=a.img},n.escapeHtml=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(a).replace(/[&<>"'\/]/g,function(a){
return b[a]})},n.getRedDialogInfo=function(a){n.getRedpointInfo(n.path,function(b){var c,d,e,f,g,j,k,l=[];if(b&&b.msg){for(b=b.msg,c=Object.keys(b),j=0,k=c.length;k>j;j++){e=b[c[j]];try{d="string"==typeof e.content?JSON.parse(e.content):e.content;
}catch(m){continue}if(g=i.get(h.getUserId()+"index_reddialog_displayed_"+c[j]))n.setRedpointInfo(n.path,16,[{id:String(c[j]),stat:"2"}]);else if(d.type&&"dialog"==d.type){if(f={id:c[j],type:d.type,page:d.page||"index",
redpoint:d.redpoint||!0,content:n.escapeHtml(d.content),img:d.img||"",link:encodeURI(d.link)||"",time:Number(b[c[j]].time)||0},d.from&&-1===d.from.split(/[\s,]+/).join(",").replace(/(^,)|(,$)/,"").split(",").indexOf(String(n.fromSource)))continue;
l.push(f)}}a(l.length?l[0]:null)}else a(null)})},n.showRedDialog=function(){n.redpointList?n.renderRedDialog(n.redpointList):n.getRedDialogInfo(function(a){a?n.renderRedDialog(a):n.initNextDialog()})},
n.setRedpointInfo=function(a,b,c){var d={cmd:String(b),uin:h.getUserId(),platid:g.iOS?"110":"109",qqver:g.QQVersion||"",osver:"",appid:a,ret:"0",type:"0",isred:"0",set:"0",mission:c},e={10337:{sReq:JSON.stringify(d)
}};f.ajax({type:"POST",url:q+"?g_tk="+j.getCSRFToken(),dataType:"json",xhrFields:{withCredentials:!0},data:JSON.stringify(e),timeout:6e4,success:function(){},error:function(){}})},n.getRedpointInfo=function(a,b){
if("function"==typeof b){var c=q+"?g_tk="+j.getCSRFToken(),d=h.getUserId(),e={uin:String(d),platid:g.iOS?"110":"109",qqver:g.QQVersion||"",osver:"",type:"0",appid:a,noset:"1"},i={10359:{sReq:JSON.stringify(e)
}};f.ajax({type:"POST",url:c,xhrFields:{withCredentials:!0},data:JSON.stringify(i),success:function(a){var c;if("string"==typeof a)try{a=JSON.parse(a)}catch(d){a=null}if(a&&0==a.ecode)try{c=a[10359].data.sRsp,
c="string"==typeof c?JSON.parse(c):c,0==c.ecode?(c="string"==typeof c.msg?JSON.parse(c.msg):c.msg,b(c)):b()}catch(d){b()}else b()},error:function(){b()}})}},n.showOtherDialog=function(){var a=this;n.getRedpointInstance(function(c){
c.queryDyanmicStatus({path:c.path.dynamic.id},function(c){var d=0;if(c&&0==c.result)if(0==c.type){if(i.get(h.getUserId()+"comic_index_guide")==g.getDateStr())return;g.iOS?g.compareVersion(g.QQVersion,"6.3.5")>=0?k.invoke("mqq.ui.setTitleButtons",{
left:{title:"返回",callback:function(){var a;return 0==d?(a=g.mediator.subscribe("actPointClose",function(){a.remove(),k.invoke("mqq.comic.popBack",{})}),b.showGuide(),void d++):void k.invoke("mqq.comic.popBack",{});
}}}):b.showGuide():g.android?k.invoke("mqq.callback",n.popBackShowGuideHandler.bind(a),function(a){k.invoke("mqq.comic.setLeftCallback",{leftcallback:a},function(){})}):b.showGuide()}else 1==c.type&&(p.shouldDisplay=!0,
setTimeout(function(){p.shouldDisplay=!1},o),b.checkState());else n.initNextDialog()})})},b.clickOpenRedDialogLink=function(a,b){d(".ui-dialog").off("touchmove",n.forbidScroll),b&&b.link&&(n.setRedpointInfo(n.path,16,[{
id:String(b.id),stat:"2"}]),n.compassReport&&n.compassReport.send({obj_id:"10081",oper_obj_type:"2",oper_obj_id:200289,ret_id:b.id||0}),d("#red_dialog_wrap").remove(),setTimeout(function(){g.asyncLoadInstance("business/comic",function(a){
a.handleUrl(b.link)})},0),b.isRed?n.showOtherDialog():n.initNextDialog())},b.clickCloseRedDialogGuide=function(a,b){n.compassReport&&n.compassReport.send({obj_id:"10081",oper_obj_type:"2",oper_obj_id:200290,
ret_id:b.id||0}),d(".ui-dialog").off("touchmove",n.forbidScroll),d("#red_dialog_wrap").remove(),b.isRed?n.showOtherDialog():n.initNextDialog()},b.checkDialogType=function(){arguments.callee;n.getRedDialogInfo(function(a){
a?a.redpoint?n.renderRedDialog(a,!0):(n.redpointList=a,n.showOtherDialog()):n.showOtherDialog()})},b.init=function(a){n.params=a.params,n.main=a.self,n.compassReport=a.compassReport,n.getSlipInstance=a.getSlipInstance,
this.checkDialogType()}});