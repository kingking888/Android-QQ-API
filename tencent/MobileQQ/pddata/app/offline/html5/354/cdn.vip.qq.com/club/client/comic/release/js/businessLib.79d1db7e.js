!function(a,b){function c(a){return function(b){return Object.prototype.toString.call(b)==="[object "+a+"]"}}function d(){return A++}function e(a){return a.match(G)[0]}function f(a){for(a=a.replace(H,"/");a.match(I);)a=a.replace(I,"/");
return a}function g(a){var b=a.length-1,c=a.charAt(b);return"#"===c?a.substring(0,b):".js"===a.substring(b-2)||a.indexOf("?")>0||".css"===a.substring(b-3)||"/"===c?a:a+".js"}function h(a){var b=v.alias;
return b&&x(b[a])?b[a]:a}function i(a){var b,c=v.paths;return c&&(b=a.match(J))&&x(c[b[1]])&&(a=c[b[1]]+b[2]),a}function j(a){var b=v.vars;return b&&a.indexOf("{")>-1&&(a=a.replace(K,function(a,c){return x(b[c])?b[c]:a;
})),a}function k(a){var b=v.map,c=a;if(b)for(var d=0,e=b.length;e>d;d++){var f=b[d];if(c=z(f)?f(a)||a:a.replace(f[0],f[1]),c!==a)break}return c}function l(a,b){var c,d=a.charAt(0);if(L.test(a))c=a;else if("."===d)c=f((b?e(b):v.cwd)+a);else if("/"===d){
var g=v.cwd.match(M);c=g?g[0]+a.substring(1):a}else c=v.base+a;return c}function m(a,b){if(!a)return"";a=h(a),a=i(a),a=j(a),a=g(a);var c=l(a,b);return c=k(c)}function n(a){return a.hasAttribute?a.src:a.getAttribute("src",4);
}function o(a,b,c){var d=V.test(a),e=N.createElement(d?"link":"script");if(c){var f=z(c)?c(a):c;f&&(e.charset=f)}p(e,b,d),d?(e.rel="stylesheet",e.href=a):(e.async=!0,e.src=a),C=e,U?T.insertBefore(e,U):T.appendChild(e),
C=null}function p(a,b,c){var d=c&&(X||!("onload"in a));return d?void setTimeout(function(){q(a,b)},1):void(a.onload=a.onerror=a.onreadystatechange=function(){W.test(a.readyState)&&(a.onload=a.onerror=a.onreadystatechange=null,
c||v.debug||T.removeChild(a),a=null,b())})}function q(a,b){var c,d=a.sheet;if(X)d&&(c=!0);else if(d)try{d.cssRules&&(c=!0)}catch(e){"NS_ERROR_DOM_SECURITY_ERR"===e.name&&(c=!0)}setTimeout(function(){c?b():q(a,b);
},20)}function r(){if(C)return C;if(D&&"interactive"===D.readyState)return D;for(var a=T.getElementsByTagName("script"),b=a.length-1;b>=0;b--){var c=a[b];if("interactive"===c.readyState)return D=c}}function s(a){
var b=[];return a.replace(Z,"").replace(Y,function(a,c,d){d&&b.push(d)}),b}function t(a,b){this.uri=a,this.dependencies=b||[],this.exports=null,this.status=0,this._waitings={},this._remain=0}if(!a.seajs){
var u=a.seajs={version:"2.1.1"},v=u.data={},w=c("Object"),x=c("String"),y=Array.isArray||c("Array"),z=c("Function"),A=0,B=v.events={};u.on=function(a,b){var c=B[a]||(B[a]=[]);return c.push(b),u},u.off=function(a,b){
if(!a&&!b)return B=v.events={},u;var c=B[a];if(c)if(b)for(var d=c.length-1;d>=0;d--)c[d]===b&&c.splice(d,1);else delete B[a];return u};var C,D,E,F=u.emit=function(a,b){var c,d=B[a];if(d)for(d=d.slice();c=d.shift();)c(b);
return u},G=/[^?#]*\//,H=/\/\.\//g,I=/\/[^/]+\/\.\.\//,J=/^([^/:]+)(\/.+)$/,K=/{([^{]+)}/g,L=/^\/\/.|:\//,M=/^.*?\/\/.*?\//,N=document,O=location,P=e(O.href),Q=N.getElementsByTagName("script"),R=N.getElementById("seajsnode")||Q[Q.length-1],S=e(n(R)||P),T=N.getElementsByTagName("head")[0]||N.documentElement,U=T.getElementsByTagName("base")[0],V=/\.css(?:\?|$)/i,W=/^(?:loaded|complete|undefined)$/,X=1*navigator.userAgent.replace(/.*AppleWebKit\/(\d+)\..*/,"$1")<536,Y=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,Z=/\\\\/g,$=u.cache={},_={},aa={},ba={},ca=t.STATUS={
FETCHING:1,SAVED:2,LOADING:3,LOADED:4,EXECUTING:5,EXECUTED:6};t.prototype.resolve=function(){for(var a=this,b=a.dependencies,c=[],d=0,e=b.length;e>d;d++)c[d]=t.resolve(b[d],a.uri);return c},t.prototype.load=function(){
var a=this;if(!(a.status>=ca.LOADING)){a.status=ca.LOADING;var b=a.resolve();F("load",b);for(var c,d=a._remain=b.length,e=0;d>e;e++)c=t.get(b[e]),c.status<ca.LOADED?c._waitings[a.uri]=(c._waitings[a.uri]||0)+1:a._remain--;
if(0===a._remain)return void a.onload();var f={};for(e=0;d>e;e++)c=$[b[e]],c.status<ca.FETCHING?c.fetch(f):c.status===ca.SAVED&&c.load();for(var g in f)f.hasOwnProperty(g)&&f[g]()}},t.prototype.onload=function(){
var a=this;a.status=ca.LOADED,a.callback&&a.callback();var b,c,d=a._waitings;for(b in d)d.hasOwnProperty(b)&&(c=$[b],c._remain-=d[b],0===c._remain&&c.onload());delete a._waitings,delete a._remain},t.prototype.fetch=function(a){
function b(){o(f.requestUri,f.onRequest,f.charset)}function c(){delete _[g],aa[g]=!0,E&&(t.save(e,E),E=null);var a,b=ba[g];for(delete ba[g];a=b.shift();)a.load()}var d=this,e=d.uri;d.status=ca.FETCHING;
var f={uri:e};F("fetch",f);var g=f.requestUri||e;return!g||aa[g]?void d.load():_[g]?void ba[g].push(d):(_[g]=!0,ba[g]=[d],F("request",f={uri:e,requestUri:g,onRequest:c,charset:v.charset}),void(f.requested||(a?a[f.requestUri]=b:b())));
},t.prototype.exec=function(){function a(b){return t.get(a.resolve(b)).exec()}var c=this;if(c.status>=ca.EXECUTING)return c.exports;c.status=ca.EXECUTING;var e=c.uri;a.resolve=function(a){return t.resolve(a,e);
},a.async=function(b,c){return t.use(b,c,e+"_async_"+d()),a};var f=c.factory,g=z(f)?f(a,c.exports={},c):f;return g===b&&(g=c.exports),null!==g||V.test(e)||F("error",c),delete c.factory,c.exports=g,c.status=ca.EXECUTED,
F("exec",c),g},t.resolve=function(a,b){var c={id:a,refUri:b};return F("resolve",c),c.uri||m(c.id,b)},t.define=function(a,c,d){var e=arguments.length;1===e?(d=a,a=b):2===e&&(d=c,y(a)?(c=a,a=b):c=b),!y(c)&&z(d)&&(c=s(d.toString()));
var f={id:a,uri:t.resolve(a),deps:c,factory:d};if(!f.uri&&N.attachEvent){var g=r();g&&(f.uri=g.src)}F("define",f),f.uri?t.save(f.uri,f):E=f},t.save=function(a,b){var c=t.get(a);c.status<ca.SAVED&&(c.id=b.id||a,
c.dependencies=b.deps||[],c.factory=b.factory,c.status=ca.SAVED)},t.get=function(a,b){return $[a]||($[a]=new t(a,b))},t.use=function(b,c,d){var e=t.get(d,y(b)?b:[b]);e.callback=function(){for(var b=[],d=e.resolve(),f=0,g=d.length;g>f;f++)b[f]=$[d[f]].exec();
c&&c.apply(a,b),delete e.callback},e.load()},t.preload=function(a){var b=v.preload,c=b.length;c?t.use(b,function(){b.splice(0,c),t.preload(a)},v.cwd+"_preload_"+d()):a()},u.use=function(a,b){return t.preload(function(){
t.use(a,b,v.cwd+"_use_"+d())}),u},t.define.cmd={},a.define=t.define,u.Module=t,v.fetchedList=aa,v.cid=d,u.resolve=m,u.require=function(a){return($[t.resolve(a)]||{}).exports};var da=/^(.+?\/)(\?\?)?(seajs\/)+/;
v.base=(S.match(da)||["",S])[1],v.dir=S,v.cwd=P,v.charset="utf-8",v.preload=function(){var a=[],b=O.search.replace(/(seajs-\w+)(&|$)/g,"$1=1$2");return b+=" "+N.cookie,b.replace(/(seajs-\w+)=1/g,function(b,c){
a.push(c)}),a}(),u.config=function(a){for(var b in a){var c=a[b],d=v[b];if(d&&w(d))for(var e in c)d[e]=c[e];else y(d)?c=d.concat(c):"base"===b&&("/"===c.slice(-1)||(c+="/"),c=l(c)),v[b]=c}return F("config",a),
u}}}(this),!function(){var a={};seajs.on("resolve",function(b){a.mapping||(a.mapping=seajs.data.config),seajs.data.config&&seajs.data.config[b.id]&&(a.mapping[b.uri=seajs.resolve(b.id,b.refUri)]=seajs.data.config[b.id]);
}),seajs.on("exec",function(b){var c=b.id||b.uri;"function"==typeof a.mapping[c]?a.mapping[c].call(b.exports):"undefined"!=typeof a.mapping[c]&&"function"==typeof b.exports.init&&b.exports.init(a.mapping[c]);
})}();var protocol=window.location.protocol,ua=navigator.userAgent,REGEXP_IOS_QQ=/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/,REGEXP_ANDROID_QQ=/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/,versionControl={
compareVersion:function(a,b){a=String(a).split("."),b=String(b).split(".");try{for(var c=0,d=Math.max(a.length,b.length);d>c;c++){var e=isFinite(a[c])&&Number(a[c])||0,f=isFinite(b[c])&&Number(b[c])||0;
if(f>e)return-1;if(e>f)return 1}}catch(g){return-1}return 0},iOS:REGEXP_IOS_QQ.test(ua),android:REGEXP_ANDROID_QQ.test(ua),QQVersion:""};versionControl.iOS&&versionControl.android&&(versionControl.iOS=!1),
versionControl.android&&(versionControl.QQVersion=function(a){return a&&(versionControl.compareVersion(a[1],a[3])>=0?a[1]:a[3])||0}(ua.match(REGEXP_ANDROID_QQ))),versionControl.iOS&&(versionControl.QQVersion=function(a){
return a&&a[3]||0}(ua.match(REGEXP_IOS_QQ)));var qqapi=versionControl.compareVersion(versionControl.QQVersion,"6.5.5")>=0&&versionControl.android||versionControl.iOS?versionControl.iOS&&versionControl.compareVersion(versionControl.QQVersion,"7.3.0")>=0?protocol+"//open.mobile.qq.com/sdk/qqapi.wk.js?_bid=152&max_age=31104000":protocol+"//open.mobile.qq.com/sdk/qqapi.https.js?_bid=2538":protocol+"//open.mobile.qq.com/sdk/qqapi.js?_bid=152";
seajs.config({base:"../js/",alias:{qqapi:qqapi,zepto:"lib/zepto.js?max_age=31536000","lib/zepto":"lib/zepto.js?max_age=31536000","widget/act_loader":"widget/act_loader.js?max_age=600",midas:protocol+"//midas.gtimg.cn/h5pay/js/api/midas.js",
imgReport:protocol+"//cdn.vip.qq.com/club/client/imgReport/imgReport.js?max_age=31104000",wangSpeedReport:protocol+"//cdn.vip.qq.com/club/reporter/performance.js?max_age=86400","lib/pay/smartpay.proxywv":protocol+"//imgcache.gtimg.cn/club/platform/lib/pay/smartpay.proxywv.js?max_age=31104000"
},config:{"business/router":function(a){seajs.use("business/map",function(a){a.init({md5:{"lib/slip":"7a81c2a3","lib/dom":"e037f4fc","lib/bj-report":"44f308bb","lib/swiper":"102311ab","lib/fastclick":"cbf397b4",
"lib/touch":"0d8b3b6c","lib/app-manager":"cde3ef9b","lib/smartpay":"9c1f1e4d","widget/redpoint":"aa64ed56","widget/radar":"8945bdf3","widget/swipeMenu":"bfb5ceaa","business/compassReport":"7659c447","business/search":"ead464e3",
"business/vip":"0023cdb8","business/userInfo":"689db0d0","business/pay":"5e6b60a0","business/report":"ec45143d","business/newIndexBubble":"29eb57f6","business/newActPoint":"7a134ef9","business/algorithRealTimeReport":"f10f0788",
"business/imgReport":"197f2085","page/otherIndex":"2615426c","widget/fullScreen":"d2bdc864","widget/pay":"984b706b","widget/img_loader":"b71354de","widget/WVUtil":"a664c6a3","widget/floor_act":"463e82c0",
"widget/yellowTips":"a645e2b6","widget/sign_v2":"e2aed45c","widget/video":"b1450c04","widget/let_it_snow":"6b1f8feb"},params:{_bid:354,max_age:31536e3}})})}}}),define("business/map",[],function(a,b,c){
b.init=function(a){seajs.on("resolve",function(b){if(b&&b.id){var c=seajs.resolve(b.id,b.refUri),d=seajs.Module.get(c);if(-1!=c.indexOf("/rel/lib/")&&(c=c.replace("/rel/lib/","/rel/js/lib/")),-1!=c.indexOf("/rel/business/")&&(c=c.replace("/rel/business/","/rel/js/business/")),
d&&d.status<(seajs.Module.STATUS&&seajs.Module.STATUS.FETCHING)){if(a&&a.md5&&a.md5[b.id]&&(c=c.replace(".js","."+a.md5[b.id]+".js")),a&&a.params){-1==c.indexOf("?")&&(c+="?");var e=c.split("?");e=e[1]||"";
for(var f in a.params)-1==e.indexOf(f+"=")&&(c+="&"+f+"="+a.params[f])}b.uri=c}}})}}),define("business/sequence",["piggy/util/cacheData","piggy/util/uri","piggy/util/cookie"],function(a,b,c){var d=b,e=a("piggy/util/cacheData"),f={},g=a("piggy/util/uri");
a("piggy/util/cookie"),f.getSequence=function(a,b){var c=a.protocol+a.hostname+a.pathname,d=parseInt(e.get(c))||0;return d?(e.set(c,++d),d):(d=Date.now(),e.set(c,d),d)},d.getPluginHandlers=function(a){
return{ajaxSend:function(b,c,d){var e=g.parseUrl(d.url);"qq.com"==e.hostname.split(".").slice(-2).join(".")&&(e.search+=(e.search.indexOf("?")>=0?"&":"?")+"sequence="+f.getSequence(e,a),d.url=g.getUri(e));
}}}}),define("business/mergeRequest",["lib/zepto","piggy/util/uri","piggy/util/net"],function(a,b,c){var d=c.exports,e=a("lib/zepto"),f=a("piggy/util/uri"),g=a("piggy/util/net"),h={};h.config={options:{
dataType:"json",cache:!1,timeout:0,xhrFields:{withCredentials:!0},plugins:{"business/security":!0,"piggy/business/cgiReport":["merge","ecode"],"business/sequence":!0},type:"POST"},params:{}},h.mapping={},
d.init=function(a,b){b?h.config=a:h.config=e.extend(!0,h.config,a)},d.getPluginHandlers=function(a){return{ajaxStart:function(a,b,c){var d=String(c.url).split("?")[0];h.mapping[d]&&h.mapping[d].proxyXhr&&h.mapping[d].optionList||(h.mapping[d]={
proxyXhr:e.ajaxSettings.xhr(),optionList:[],headers:{},interval:0,instance:null}),c.realTimeout=c.timeout,c.timeout=0,c.xhr=function(a,b){return function(){return a.open=function(){},a.send=function(){
1===b.optionList.push(c)&&setTimeout(function(){b.proxyXhr.send=function(a){return function(){for(var c=["readyState","response","responseText","responseType","responseXML","status","statusText"],d=["abort","error","load","loadend","loadstart","progress","timeout","readystatechange"],f=0,g=d.length;g>f;f++)!function(a,d){
b.proxyXhr[a]=function(){var f,g;if(d&&(g=d.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))),"onreadystatechange"===a&&4==b.proxyXhr.readyState&&!/^\s*$/.test(b.proxyXhr.responseText))try{f=e.parseJSON(b.proxyXhr.responseText);
}catch(h){f=JSON.stringify({result:h.number||-1,message:h.message||h.name||"parseError"})}for(var i=0,j=b.optionList.length;j>i;i++){var k=b.optionList[i].xhr();if("function"==typeof k[a]){for(var l=0,m=c.length;m>l;l++)if(f&&"responseText"===c[l])"string"==typeof f?k[c[l]]=f:f.data&&f.data[i]?f.data[i].retBody?k[c[l]]=JSON.stringify(f.data[i].retBody):k[c[l]]=JSON.stringify({
result:f.data[i].retCode||-1,message:f.data[i].retMsg||"retBody nofound"}):k[c[l]]=JSON.stringify({result:f.ecode||-1,message:"key nofound"});else try{k[c[l]]=b.proxyXhr[c[l]]}catch(h){}k[a]&&k[a].apply(k,Array.prototype.slice.call(arguments,0));
}}return d?g:void 0}}("on"+d[f],b.proxyXhr["on"+d[f]]);return a.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))}}(b.proxyXhr.send);for(var a={},c=e.extend(!0,{merge:b.optionList.length},h.config&&h.config.params),i=6e4,j=0,k=b.optionList.length;k>j;j++)a[j]=b.optionList[j]&&b.optionList[j].data&&e.extend(!0,{
param:{tt:0}},b.optionList[j].data),c=e.extend(!0,c,f.parseQueryString(f.parseUrl(b.optionList[j].url).search)),i=Math.max(i,b.optionList[j].realTimeout||0);b.instance=g.ajax(e.extend(!0,{},h.config&&h.config.options,{
url:d+"?"+e.param(c),timeout:i,data:{param:JSON.stringify(a)},headers:b.headers,xhr:function(){return b.proxyXhr},error:function(a,c,d){if("timeout"===c||"abort"===c)for(var f,g=0,h=b.optionList.length;h>g;g++)f=e.extend(!0,{},b.optionList[g]||{}),
"function"==typeof f.error&&f.error(a,c,d),f.context&&(f.data=f.data&&e.param(f.data,f.traditional),f.url=f.data?(f.url+"&"+f.data).replace(/[&?]{1,2}/,"?"):f.url,e(f.context).trigger(e.Event("ajaxError"),[f.xhr,f,c]));
}})),h.mapping[d]=null},0)},a.getDuration=function(){return b.instance&&"function"==typeof b.instance.getDuration?b.instance.getDuration.apply(this,Array.prototype.slice.call(arguments,0)):0},a.getAllResponseHeaders=function(){
return b.proxyXhr.getAllResponseHeaders.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))},a.getResponseHeader=function(){return b.proxyXhr.getResponseHeader.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0));
},a.setRequestHeader=function(a,c){b.headers[a]=c},a}}((c.xhr||e.ajaxSettings.xhr)(),h.mapping[d])}}}}),define("business/security",["piggy/util/uri","piggy/util/cookie"],function(a,b,c){var d=b,e={},f=a("piggy/util/uri"),g=a("piggy/util/cookie");
d.getCSRFToken=function(a){var b=5381,c=g.get("skey");if(c=c||a&&a.skey){for(var d=0,e=c.length;e>d;d++)b+=(b<<5)+c.charCodeAt(d);return 2147483647&b}return!1},e.compareVersion=function(a,b){a=String(a).split("."),
b=String(b).split(".");try{for(var c=0,d=Math.max(a.length,b.length);d>c;c++){var e=isFinite(a[c])&&Number(a[c])||0,f=isFinite(b[c])&&Number(b[c])||0;if(f>e)return-1;if(e>f)return 1}}catch(g){return-1}
return 0},e.QQVersion=function(){var a,b,c=navigator.userAgent,d=/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/,f=/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/;return a=f.test(c),b=d.test(c),b&&a&&(b=!1),
b?function(a){return a&&a[3]||0}(c.match(d)):a?function(a){return a&&(e.compareVersion(a[1],a[3])>=0?a[1]:a[3])||0}(c.match(f)):""}(),e.getPrivateToken=function(){var a="";return e.compareVersion(e.QQVersion,"6.3")>=0&&(a=g.get("pt4_token")||""),
"&p_tk="+encodeURIComponent(a)},d.getPluginHandlers=function(a){var b=this;return{ajaxSend:function(c,d,g){var h=f.parseUrl(g.url);h.hostname&&"qq.com"!=h.hostname.split(".").slice(-2).join(".")||(h.search+=(h.search.indexOf("?")>=0?"&":"?")+"g_tk="+b.getCSRFToken(a)+e.getPrivateToken(),
g.url=f.getUri(h))}}}}),define("business/compassReport",["lib/zepto","business/report","zepto","piggy/util/net","business/router","business/jsbridge","business/common","piggy/util/cacheData","piggy/util/uri","piggy/util/cookie","piggy/util/tpl","piggy/util/report","piggy/util/process"],function(a,b,c){
var d,e,f=a("lib/zepto"),g=a("business/report")||{},h=a("piggy/util/cacheData"),i=a("piggy/util/uri"),j=a("business/jsbridge"),k=a("business/common"),l=a("business/router"),m=l.getParams(),n=h.get("oper_path")||{
page_id:"NULL",oper_obj_id:"NULL",ses_id:"NULL",ext4:"NULL"},o=h.get("pageIdMap")||{},p={},q="~",r={tbName:"dc00145",biz_id:"8001",biz_subid:"8001001",mod:m._cfrom?m._cfrom:m.from?m.from:6},s={},t=m.algo_id||"0";
!function(){document.addEventListener("click",function(a){p.oper_obj_id="NULL",h.set("oper_path",p)},!0),k.bindPageVisibleEvent(function(a){a.hidden||(h.set("oper_path",""),b.isDetailPage(p.page_id)&&h.set("detailpage_from",""),
b.isNewIndexPage(p.page_id)&&h.set("algo_id",""))})}();var u={};b.init=function(a){u=a},c.exports=b=g;var v=b.send;v&&"function"==typeof v&&(b.send=function(a,c){a=f.extend(!0,{},u,a);var d=a&&a.resource_name&&String(l.resourceIdConfig[a.resource_name]||"");
if(d&&"string"==typeof d){if(/98765$/.test(d)){var e=String(a.page_id);d+=a.resource_id||("3039"===e||"3040"===e?a.ext5:"")}a.is_new=String(d)||""}b.cachePath(a),b.cachePageId(a.page_id);var h=f.extend({},r,a);
a.report_path===!0&&(k.iOS||k.isComicWebView)?(delete h.report_path,b.getReportInfo(function(a){f.extend(h,a),window.DETAILPAGE_FROM=h.detailpage_from,window.LAND_PAGE=h.land_page,window.OBJ_OWNERID=h.obj_ownerid,
v.apply(g,[h,c])},!0)):v.apply(g,[h,c])}),b.cachePageId=function(a){var c=location.pathname,d=c.substring(c.lastIndexOf("/")+1,c.indexOf(".html"));"NULL"===b.getPageId()&&(o[d]=a,h.set("pageIdMap",o)),
j.invoke("mqq.data.writeH5Data",{callid:"id_"+Date.now(),host:"qq.com",path:"qqcomic",key:["pageId",d].join("_"),data:a},function(a){})},b.cachePath=function(a){p={page_id:a.page_id,oper_obj_id:a.oper_obj_id,
ses_id:a.ses_id,ext4:a.ext4},h.set("oper_path",p),h.set("algo_id",a.algo_id||t),b.isDetailPage(a.page_id)&&h.set("detailpage_from",b.getDetailPageFrom())},b.getPath=function(a){return a===!0?h.get("detailpage_from")||"NULL_NULL_NULL_NULL~NULL_NULL_NULL_NULL":b.getDetailPageFrom();
},s.returnNull=function(a){return"undefined"==typeof a?"NULL":a},b.getReportInfo=function(a,c){arguments.callee,!d&&k.compareVersion(k.QQVersion,"6.5.8")>=0?k.getWebViewTypeIsComic(function(c){c?j.invoke("mqq.comic.getReporterInfo",{},function(c){
var e=c&&c.data||{};b.getPageId(e.land_page,function(c){d={from:r.mod,obj_pos:m.pos||"",land_page:e.land_page?c:"NULL",algo_id:e.algo_id||t,obj_ownerid:e.obj_ownerid||m.obj_ownerid||"NULL"},d.detailpage_from=b.getDetailPageFrom(),
a&&a(d)})}):a&&setTimeout(function(){d=d||{land_page:"NULL",algo_id:t,obj_ownerid:m.obj_ownerid||"NULL"},d.detailpage_from=b.getDetailPageFrom(),a(d)})}):a&&setTimeout(function(){d=d||{land_page:"NULL",
algo_id:t,obj_ownerid:m.obj_ownerid||"NULL"},d.detailpage_from=b.getDetailPageFrom(),a(d)})},b.getPageId=function(a,b){var c=a?i.parseUrl(a).pathname:location.pathname,d=c.substring(c.lastIndexOf("/")+1,c.indexOf(".html"));
return o[d]?b&&b(o[d]):j.invoke("mqq.data.readH5Data",{callid:"id_"+Date.now(),host:"qq.com",path:"qqcomic",key:["pageId",d].join("_")},function(a){a&&a.response&&a.response.data?b&&b(a.response.data):b&&b("NULL");
}),o[d]||"NULL"},b.createPath=function(a,c){return b.createCurrentPath(a)+q+b.createCurrentPath(c)},b.createCurrentPath=function(a){return[s.returnNull(a.page_id),s.returnNull(a.oper_obj_id),s.returnNull(a.ses_id),s.returnNull(a.ext4),s.returnNull(a.ext8)].join("_");
},b.getDetailPageFrom=function(){if(!e&&b.isDetailPage(p.page_id)){var a=m.detailpage_from||"NULL_NULL_NULL_NULL_NULL~NULL_NULL_NULL_NULL_NULL",c=m.prepage||b.createCurrentPath(n),d=a.split(q)[1];e=c+q+d;
}return encodeURIComponent(e)||"NULL_NULL_NULL_NULL_NULL~NULL_NULL_NULL_NULL_NULL"},b.isDetailPage=function(a){return 102==a||120==a},b.isNewIndexPage=function(a){return 3039==a}}),define("business/report",["lib/zepto","piggy/util/net","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","business/common","piggy/util/cacheData","piggy/util/tpl","piggy/util/report"],function(a,b,c){
var d=a("lib/zepto"),e=a("piggy/util/net"),f=a("business/router"),g=a("business/jsbridge"),h={};a("business/common"),h.safeMatch=function(a,b,c){var d=a.match(b||"");return c=isNaN(c)?0:c,d?d[c]:""};var i={
tbName:"dc00145",imei:"",domain:"",domain_id:"",domain_ver:"",device_type:"",mqq_ver:"",mqq_sub_ver:"",net_type:"",res:"",src:"",ext7:seajs.pageVersion||0};b.baseData=i,b.init=function(a){var b="pc",c=101,d="",e="",j="",k="",l="",m="unknow",n=navigator.userAgent.toLowerCase();
if(n.indexOf("ipad")>-1?(b="ios",c=212,d="i"+h.safeMatch(n,/os\s[\d_]+/,0),e="ipad"):n.indexOf("iphone")>-1?(b="ios",c=211,d="i"+h.safeMatch(n,/os\s[\d_]+/,0),e="iphone"):n.indexOf("ipod")>-1?(b="ios",
c=213,d="i"+h.safeMatch(n,/os\s[\d_]+/,0),e="ipod"):-1!=n.indexOf("macintosh")||-1!=n.indexOf("mac os x")?(c="mac os",e="mac"):n.indexOf("android")>-1?(b="android",c=201,d=h.safeMatch(n,/android\s[\d\.]+/,0)):n.indexOf("windows phone")>-1?(b="windows phone",
c=240,d=h.safeMatch(n,/windows phone \d+/,0)):n.indexOf("nt 6.1")>-1?d="windows 7":n.indexOf("nt 6.0")>-1?d="windows vista":n.indexOf("nt 5.2")>-1?d="windows 2003":n.indexOf("nt 5.1")>-1?d="windows xp":n.indexOf("nt 5.0")>-1?d="windows 2000":-1!=n.indexOf("windows")||-1!=n.indexOf("win32")?d="windows":n.indexOf("series")>-1?(b="Series40",
c=230):n.indexOf("symbianos")>-1?(b="Series60",c=230):n.indexOf("blackberry")>-1?(b="blackberry",c=250,d=h.safeMatch(n,/blackberry\s[\d_]+/,0)):d=n.indexOf("playbook")>-1?"PlayBook"+h.safeMatch(n,/RIM Tablet OS\s[\d_]+/,0):-1!=n.indexOf("linux")?"linux":"other",
n.indexOf("msie")>-1?(j="ie",n.indexOf("qqbrowser")>-1?(l=n.match(/qqbrowser[\/\s]([\d\.]+)/),k="qqbrowser_ie "+parseInt(l&&l[1])):n.indexOf("se 2.x metasr 1.0.")>-1?k="SouGou_ie":n.indexOf("maxthon")>-1?k="maxthon_ie":(l=n.match(/msie\s([\d\.]+)/),
k="ie "+parseInt(l&&l[1]))):n.indexOf("opera")>-1?(j="opera",l=n.match(/opera[\/\s]([\d\.]+)/),k="opera "+parseFloat(l&&l[1])):n.indexOf("firefox")>-1?(j="firefox",l=n.match(/firefox\/([\d\.]+)/),k="firefox "+parseInt(l&&l[1])):n.indexOf("chrome")>-1?(j="chrome",
n.indexOf("qqbrowser")>-1?(l=n.match(/opera[\/\s]([\d\.]+)/),k="qqbrowser_webkit "+parseInt(l&&l[1])):n.indexOf("se 2.x metasr 1.0.")>-1?k="SouGou_webkit":n.indexOf("maxthon")>-1?k="maxthon_webkit":(l=n.match(/chrome\/([\d\.]+)/),
k="chrome "+parseInt(l&&l[1]))):n.indexOf("safari")>-1?(j="safari",l=n.match(/version\/([\d\.]+)/),k="safari "+parseInt(l&&l[1])):(j="other",k="other"),i.domain=b,i.domain_id=c,i.domain_ver=d,i.device_type=e,
i.src=f.getParams("ADTAG"),i.res=screen.width+"x"+screen.height,setTimeout(function(){g.invoke("mqq.device.isMobileQQ",function(a){a?(g.invoke("mqq.device.getNetworkType",function(a){switch(a){case 1:m="WiFi";
break;case 2:m="2G";break;case 3:m="3G";break;case 4:m="4G";break;default:m="unknow"}i.net_type=m}),g.invoke("mqq.QQVersion",null,function(a){i.mqq_ver=a}),g.invoke("mqq.device.getDeviceInfo",function(a){
i.imei=a&&a.identifier?a.identifier:""})):i.net_type=m})},0),a)for(var o in a)"undefined"!=typeof i[o]&&(i[a[o]]=i[o],delete i[o])},h.reportByCgi=function(a){e.ajax({url:window.location.protocol+"//report.vip.qq.com/cgi-bin/report",
data:a,cache:!1,dataType:"json",timeout:15e3,plugins:{"piggy/business/cgiReport":["tbName","ecode"]},xhrFields:{withCredentials:!0},success:function(a){},error:function(a,b,c){}})},h.reportBatch=function(a,b){
e.ajax({url:window.location.protocol+"//report.vip.qq.com/cgi-bin/report_batch?"+d.param(a),data:JSON.stringify(b),type:"POST",cache:!1,dataType:"json",timeout:15e3,plugins:{"piggy/business/cgiReport":["tbName","ecode"]
},xhrFields:{withCredentials:!0},success:function(a){},error:function(a,b,c){}})},h.reportByMqq=function(a){var b=String(a.type);delete a.type,delete a.tbName,mqq.data.pbReport(String(b),d.param(a))},b.send=function(a,b){
var c=this,e=c.send;if(b=b||a&&a.notBatch,a&&a.notBatch&&delete a.notBatch,d.isArray(a)||(a=[a]),a=a.filter(function(a){return h.formatData(a),!!a.tbName}),b){var f=h.getCommonData(a);h.reportBatch(f,a);
}else e.sendList=e.sendList||[],e.sendList=e.sendList.concat(a),e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(function(){var a=h.getCommonData(e.sendList);h.reportBatch(a,e.sendList),e.timeout=null,
e.sendList=[]},0)},h.formatData=function(a){var b;if(d.isPlainObject(a))for(b in a)if(a.hasOwnProperty(b))switch(b){case"uin":case"imp_date":a[b]=parseInt(a[b]);break;default:a[b]=String(a[b])}},h.getCommonData=function(a){
if(1===a.length)return i;var b=d.extend({},a[0]);return a.forEach(function(a){Object.keys(b).forEach(function(c){b[c]!==a[c]&&b.hasOwnProperty(c)&&delete b[c]})}),a.forEach(function(a){Object.keys(b).forEach(function(b){
a.hasOwnProperty(b)&&"tbName"!==b&&delete a[b]})}),d.extend({},i,b)},b.init()}),define("business/detaillogReport",["lib/zepto","business/jsbridge","zepto"],function(a,b,c){var d=(a("lib/zepto"),a("business/jsbridge")),e={};
e.config={id:"qqcomic",subid:"cgiError",level:"debug"},b.getPluginHandlers=function(a){var b=this,c=a;return c=c||{},c.code=c.code||"result",c.message=c.message||"message",{ajaxStart:function(a,b){e.start=+new Date;
},ajaxSuccess:function(a,d,f,g){var h,i,j="";if(e.end=+new Date,g){for(var k=String(c.code).split("."),l=0,m=k.length,n=g;m>l&&n;)n=n[k[l++]];"undefined"!=typeof n&&(i=n);for(var o=String(c.message).split("."),p=0,q=o.length,r=g;q>p&&r;)r=r[o[p++]];
"undefined"!=typeof r&&(j=r)}i&&0!=i&&(h={result:i,message:j},b.writeLog(c,h,f))},ajaxError:function(a,d,f,g){var h={};e.end=+new Date,h=d.status>=400&&d.status<600?{result:6e5,message:"ajaxError:"+d.status
}:{result:600001,message:g},b.writeLog(c,h,f)}}},b.writeLog=function(a,b,c){if(a=a||{},/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/.test(decodeURIComponent(c.url))){var f,g,h=(RegExp.$4||"",
RegExp.$5||""),i=RegExp.$6||"",j=[];if(f="POST"===c.type.toUpperCase()&&c.data?decodeURIComponent(c.data):i,/param=([^\=\&\#]+)/g.test(f))j=e.evalObject(RegExp.$1);else{var k,l;k=/module=([^\=\&\#]+)/g.exec(f),
k&&(k=k[1]),l=/method=([^\=\&\#]+)/g.exec(f),l&&(l=l[1]),(k||l)&&j.push({module:k||"",method:l||""})}return g="path:"+h+",method:"+JSON.stringify(j)+",error:"+JSON.stringify(b)+",startTime:"+e.start+",endTime:"+e.end,
d.clientLog({id:a.id||e.config.id,subid:a.subid||e.config.subid,content:g,level:a.level||e.config.level}),!0}return!1},e.evalObject=function(a){function b(a,c){for(var d in a)"object"==typeof a[d]&&(a[d].module||a[d].method?c.push({
module:a[d].module||"",method:a[d].method||""}):b(a[d],c))}var c,d=[];try{return c=JSON.parse(a),b(c,d),d}catch(e){return d}}}),define("business/common",["lib/zepto","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","piggy/util/cacheData","piggy/util/tpl","piggy/util/report"],function(a,b,c){
function d(a){function c(){}var d,e=document.createElement("iframe");return e.style.cssText="display:none;width:0px;height:0px;",b.iOS&&(e.onload=c,e.src=a),(document.body||document.documentElement).appendChild(e),
b.android&&(e.onload=c,e.src=a),d=void 0,setTimeout(function(){e.parentNode.removeChild(e)},0),d}var e={},f=a("lib/zepto"),g=a("business/router"),h=a("piggy/util/cookie"),i=a("business/jsbridge"),j=a("piggy/util/cacheData"),k=a("piggy/util/tpl"),l=a("piggy/util/uri"),m=a("piggy/util/report").getInstance("business/compassReport"),n=navigator.userAgent,o=/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/,p=/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/,q=/VipComic/;
b.hasClicked=!1,b.clickedTimer=null,b.compareVersion=function(a,b){a=String(a).split("."),b=String(b).split(".");try{for(var c=0,d=Math.max(a.length,b.length);d>c;c++){var e=isFinite(a[c])&&Number(a[c])||0,f=isFinite(b[c])&&Number(b[c])||0;
if(f>e)return-1;if(e>f)return 1}}catch(g){return-1}return 0},b.compareQQVersion=function(a){return b.compareVersion(b.QQVersion,a)},b.iOS=o.test(n),b.android=p.test(n),b.iOS&&b.android&&(b.iOS=!1),b.android&&(b.QQVersion=function(a){
return a&&(b.compareVersion(a[1],a[3])>=0?a[1]:a[3])||0}(n.match(p))),b.iOS&&(b.QQVersion=function(a){return a&&a[3]||0}(n.match(o)),b.iOSSysVersion=n.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".")),
b.isComicWebView=q.test(n)||b.android&&b.compareVersion(b.QQVersion,"7.0.0")>=0,b.isStrictComicWebView=function(){var a=g.getParams()||{};return q.test(n)||b.android&&b.compareVersion(b.QQVersion,"7.0.0")>=0&&4==a._webviewtype;
}(),b.isPureComicWebView=q.test(n),b.getVideoInitPlayParam=function(a){b.android&&b.compareVersion(b.QQVersion,"6.7.0")>=0?i.invoke("mqq.offline.isCached",{bid:354},function(b){b>45530||-1==b?a&&a(1):a&&a();
}):a&&a()};var r,s="jsbridge://",t=0;r={request:function(a,b,c){var e,f={};"function"==typeof b&&(c=b,b=null),c=c||function(){},t++,f=null==b?{}:b,f.callback="comicLiteJsBridge_"+(t+parseInt(100*Math.random())),
window[f.callback]=c,e=s+"comic/"+a+"?p="+JSON.stringify(f),d(e)},execGlobalCallback:function(a,b){window[a](b)}},b.comicLiteJsBridge=r,b.errCode={NO_LOGIN:-20004},b.setTitleBarBgColor=function(a,b){var c=this;
if(c.iOS||c.isPureComicWebView)i.invoke("mqq.comic.setTitleBarBackground",{alpha:a.alpha});else{var d=function(){i.invoke("mqq.ui.setWebViewBehavior",{titleText:0==a.alpha?"":document.title,navBgColor:0==a.alpha?0:46840,
progressBar:!1,navBgColorAlpha:a.alpha})};setTimeout(function(){d()},50),setTimeout(function(){d()},250)}},b.getTitleBarHeight=function(a){i.invoke("mqq.comic.getTitleBarHeight",{},a)},b.setTitleName=function(a,b){
var c=this;c.iOS||c.isComicWebView?i.invoke("mqq.comic.setTitleName",{name:a.name}):document.title=a.name},b.setDocumentTitle=function(a){var b=this;document.title=a,b.iOS?i.invoke("mqq.ui.refreshTitle",{}):b.setTitleName({
name:a})},b.bindPageVisibleEvent=function(a){document.addEventListener("qbrowserVisibilityChange",function(b){a&&a(b)})},b.setLastAccessTime=function(){+new Date},b.getLastAccessSep=function(){return"none";
},b.getNowTime=function(b){var c=new Date,d=c.getTime()/1e3,e=1e3*d;a.async("piggy/util/time",function(a){a.getLeftSecond(d,function(a){if(0==a.result){var c=a.data;d=(new Date).getTime()/1e3,e=1e3*parseInt(d-c);
}b(e)})})},b.showLoading=function(a){f("#"+a).show()},b.hideLoading=function(a){f("#"+a).hide()},b.sendRequest=function(c){var d,j,k=this,l=c.callback||function(){},n=c.url?c.url+"&clientVer="+(b.QQVersion||"5.8.1"):g.createUrl("vpcm/cgi-bin/get_comic_mainpage",{
clientVer:b.QQVersion||"5.8"}),o={"piggy/business/cgiReport":["module,method","result"],"business/security":!0,"business/detaillogReport":{}};c.data&&"object"==typeof c.data&&!f.isArray(c.data)&&(c.data.timestamp=Date.now()),
c.data&&c.data.param&&(d=g.getParams()||{},j=JSON.parse(c.data.param),j.cfrom=parseInt(d._cfrom?d._cfrom:d.from?d.from:6),c.data.version=parseInt(1),c.data.param=JSON.stringify(j)),c.plugins&&(o=f.extend(o,c.plugins)),
a.async("piggy/util/net",function(a){try{k.writeLog({content:["cgiLog","requestBegin",n,JSON.stringify(c)].join("|"),level:"error"})}catch(b){k.writeLog({content:["cgiLog","requestBeginCatch",n].join("|"),
level:"error"})}a.ajax({url:n,data:c.data,type:c.type||"GET",timeout:c.timeout||6e4,xhrFields:{withCredentials:!0},plugins:o,success:function(a){a=a||{};try{k.writeLog({content:["cgiLog","requestEnd",n,JSON.stringify(c)].join("|"),
level:"error"})}catch(b){k.writeLog({content:["cgiLog","requestEndCatch",n].join("|"),level:"error"})}if("undefined"!=typeof a.ecode&&(a.result=a.ecode,delete a.ecode),a.result==k.errCode.NO_LOGIN||-19981==a.result){
var d="skey";-19981===a.result&&(d="pt4_token");var f=e.getPrivateToken(),g=h.get("skey");k.compareVersion(k.QQVersion,"6.5.0")>=0?i.invoke("mqq.data.updateLoginInfo",{key:d},function(a){var b=a||{msg:"error call"
};m.send({tbName:"dc00145",biz_id:"8001",biz_subid:"8001001",oper_obj_type:"100",oper_obj_id:100006,ext1:d,ext2:JSON.stringify(b),ext3:(new Date).getTime(),ext4:e.getPrivateToken(),ext5:f,ext6:g}),b.key=d,
b.prevToken=f,b.skey=g,b.time=(new Date).getTime(),b.token=e.getPrivateToken(),k.writeLog({content:JSON.stringify(b)}),a&&0===a.result&&0===a.data.result?window.location.reload():e.openLogin()}):e.openLogin();
}else l(a.data?a:{result:-4});try{k.writeLog({content:["cgiLog","detail",n,JSON.stringify(c),JSON.stringify(a)].join("|")})}catch(b){k.writeLog({content:["cgiLog","detailCatch",n,JSON.stringify(c),a].join("|")
})}},error:function(a,b,d){k.writeLog({content:["cgiErrLog",n,JSON.stringify(c),b,d||""].join("|"),level:"error"}),e.errorCb(b,l)}})})},b.sendMergeRequest=function(b){var c,d=this,j=b.callback||function(){},k={
"piggy/business/cgiReport":["module,method","result"],"business/security":!0,"business/detaillogReport":{}};b.plugins&&(k=f.extend(k,b.plugins)),b.noNeedMerge||(k["business/mergeRequest"]=!0,b.type="GET",
b.processData=!0),b.data&&b.data.param&&(c=g.getParams()||{},b.data.param.cfrom=parseInt(c._cfrom?c._cfrom:c.from?c.from:6)),!b.noNeedMerge&&b.data&&"object"==typeof b.data&&!f.isArray(b.data)&&(b.data.timestamp=Date.now()),
b.url=b.url.indexOf("?")>0?b.url+"&version=1":b.url+"?version=1",b.url=b.url||g.createUrl("vpcm/cgi-bin/get_comic_mainpage"),a.async("piggy/util/net",function(a){try{d.writeLog({content:["cgiLog","requestBegin",JSON.stringify(b)].join("|"),
level:"error"})}catch(c){d.writeLog({content:["cgiLog","requestBeginCatch",b.url].join("|"),level:"error"})}a.ajax({url:b.url,type:b.type||"POST",data:b.data,cache:!1,processData:b.processData||!1,contentType:!1,
timeout:b.timeout||6e4,dataType:"json",xhrFields:{withCredentials:!0},plugins:k,success:function(a){a=a||{};try{d.writeLog({content:["cgiLog","requestEnd",JSON.stringify(b)].join("|"),level:"error"})}catch(c){
d.writeLog({content:["cgiLog","requestBeginEnd",b.url].join("|"),level:"error"})}if("undefined"!=typeof a.ecode&&(a.result=a.ecode,delete a.ecode),!a||-20004!=a.result&&-12e4!=a.result&&120002!=a.result&&-19981!=a.result)j(a);else{
var f="skey";-19981===a.result&&(f="pt4_token");var g=e.getPrivateToken(),k=h.get("skey");d.compareVersion(d.QQVersion,"6.5.0")>=0?i.invoke("mqq.data.updateLoginInfo",{key:f},function(a){var b=a||{msg:"error call"
};m.send({tbName:"dc00145",biz_id:"8001",biz_subid:"8001001",oper_obj_type:"100",oper_obj_id:100006,ext1:f,ext2:JSON.stringify(b),ext3:(new Date).getTime(),ext4:e.getPrivateToken(),ext5:g,ext6:k}),b.key=f,
b.prevToken=g,b.skey=k,b.time=(new Date).getTime(),b.token=e.getPrivateToken(),d.writeLog({content:JSON.stringify(b)}),a&&0===a.result&&0===a.data.result?window.location.reload():e.openLogin()}):e.openLogin();
}try{d.writeLog({content:["cgiLog","detail",b.url,JSON.stringify(b),JSON.stringify(a)].join("|")})}catch(c){d.writeLog({content:["cgiLog","detailCatch",b.url,JSON.stringify(b),a].join("|")})}},error:function(a,c,f){
d.writeLog({content:["cgiErrLog",b.url,JSON.stringify(b),c,f||""].join("|"),level:"error"}),e.errorCb(c,j)}})})},b.sendSrfMergeRequest=function(b){var c=this,d=b.callback||function(){},g={"piggy/business/cgiReport":["module,method","result"],
"business/security":!0,"business/srfMergeRequest":!0};b.plugins&&(g=f.extend(g,b.plugins)),b.url=b.url||location.protocol+"//proxy.vac.qq.com/cgi-bin/srfentry.fcgi",a.async("piggy/util/net",function(a){
try{c.writeLog({content:["cgiLog","requestBegin",JSON.stringify(b)].join("|"),level:"error"})}catch(f){c.writeLog({content:["cgiLog","requestBeginCatch",b.url].join("|"),level:"error"})}a.ajax({url:b.url,
cgiId:b.cgiId,type:b.type||"POST",data:{req:b.data},cache:!1,processData:b.processData||!1,contentType:!1,timeout:b.timeout||6e4,dataType:"json",xhrFields:{withCredentials:!0},plugins:g,success:function(a){
a=a||{};try{c.writeLog({content:["cgiLog","requestEnd",JSON.stringify(b)].join("|"),level:"error"})}catch(e){c.writeLog({content:["cgiLog","requestBeginEnd",b.url].join("|"),level:"error"})}"undefined"!=typeof a.ecode&&(a.result=a.ecode,
delete a.ecode),d(a);try{c.writeLog({content:["cgiLog","detail",b.url,JSON.stringify(b),JSON.stringify(a)].join("|")})}catch(e){c.writeLog({content:["cgiLog","detailCatch",b.url,JSON.stringify(b),a].join("|")
})}},error:function(a,f,g){c.writeLog({content:["cgiErrLog",b.url,JSON.stringify(b),f,g||""].join("|"),level:"error"}),e.errorCb(f,d)}})})},e.openLogin=function(){a.async("widget/login",function(a){a.openLogin(function(){
window.location.reload()})})},e.errorCb=function(a,c){var d=function(){c("timeout"==a?{result:6e5,message:"很抱歉，访问后台服务器超时了，请您稍后重试哟：）"}:"abort"==a?{result:600001,message:"很抱歉，后台服务器出错了，请您稍后重试哟：）"}:"parsererror"==a?{
result:600002,message:"很抱歉，后台数据格式有问题，程序员哥哥正在修复中，请您稍后重试哟：）"}:"noNetwork"==a?{result:600004,message:"似乎进入了没有网络的异次元"}:{result:600003,message:"很抱歉，后台服务器出了点问题，请您稍后重试哟：）"})};"function"==typeof c&&(b.android||b.iOS?i.invoke("mqq.device.getNetworkInfo",function(b){
b&&0==b.type?(a="noNetwork",d(a,c)):d(a,c)}):d(a,c))},b.debug=function(a){setTimeout(function(){alert(JSON.stringify(a))})},b.trace=function(a){(new Image).src="https://a.qq.com/a?a="+a+"&_="+(new Date).getTime();
},b.getPermission=function(a){var b={free:1,limit:2,vip:4,svip:8,section:16,comicLimit:32,triggerLimit:64,levelLimit:128,vipFree:256},c={};for(var d in b)b[d]&a&&(c[d]=1);return c},b.showOffPrompt=function(){
var a=this,b=j.get("comic_expire");b&&(j.set("comic_expire",0),a.showTips("囧…这本漫画下架了…先去看别的吧～"))},b.showTips=function(a,c){var d=b.showTips,e={};a&&d.prevTxt!==a&&(e.text=a,c&&c.iconMode&&(e.iconMode=c.iconMode),
i.invoke("mqq.ui.showTips",e),d.prevTxt=a,clearTimeout(d.timer),d.timer=setTimeout(function(){d.prevTxt=""},800))},b.isWechat_6_5_6=function(){var a=n.match(/MicroMessenger\/([\d\.]+)/);return a&&b.compareVersion(a[1],"6.5.6")>=0?!0:!1;
},b.launchMqq=function(){function a(){WeixinJSBridge.invoke("launchApplication",{schemeUrl:e},function(a){})}var b=this,c=window.location.href,d="mqqapi://forward/url?url_prefix=base64Url&version=1&src_type=web",e=d.replace("base64Url",window.btoa(c));
if(b.isWechat_6_5_6())"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",a,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",a),
document.attachEvent("onWeixinJSBridgeReady",a)):a();else if(/(iphone os)|(ipad)/.test(n.toLowerCase()))window.location.href=e;else{var g=f('<iframe src="'+e+'" style="display: none;"></iframe>');f("body").append(g);
}},b.getDateStr=function(){var a=new Date,b=String(a.getDay()),c=String(a.getMonth()+1),d=String(a.getFullYear());return d+c+b},b.getDateFormat=function(a,b){function c(a){return a>9?a:"0"+a}var d="undefined"==typeof a?new Date:new Date(a);
"undefined"==typeof b&&(b="YYYY-MM-DD hh:mm:ss");var e=String(c(d.getDate())),f=String(c(d.getMonth()+1)),g=String(d.getFullYear()),h=String(c(d.getHours())),i=String(c(d.getMinutes())),j=String(c(d.getSeconds())),k=b.replace(/YYYY/g,g).replace(/MM/g,f).replace(/DD/g,e).replace(/hh/g,h).replace(/mm/g,i).replace(/ss/g,j);
return k},b.showDyanmicEnter=function(a){var c=this,d=0,e="comic_show_dynamic_"+g.getUserId()+c.getDateStr();try{var h=j.get(e);h&&(d=h)}catch(i){}if(3>d){var l=k.get(c.getDynamicTpl());c.openDynamic=a,
f("#dynamic_wrap").replaceWith(l({},k.getInstance({action:b})))}j.set(e,d+1)},b.hideDyanmicEnter=function(){f("#dynamic_tips").hide()},b.getDynamicTpl=function(){return'<div id="dynamic_tips" class="ui-tooltips ui-tooltips-guide"><div class="ui-tooltips-cnt ui-border-b"><i class="logo"></i>开启波洞星球，更多精彩～<button class="ui-btn" onclick="<%=this.getInvoke(\'action.openDynamic\')%>">开启</button></div>';
},b.appendParam=function(a,b,c){var d=l.parseUrl(a),e=d.search||"",g=a.indexOf("?")>0?a.slice(0,a.indexOf("?")):a,h=l.parseQueryString(e)||{};return h[b]=c,a=g+"?"+f.param(h)},b.getParam=function(a,b){
var c=l.parseUrl(a),d=c.search||"",e=l.parseQueryString(d)||{};return e[b]},b.openClientPage=function(a,c){var d=this,e="",f={};b.hasClicked||(b.hasClicked=!0,b.clearClickedTimer(),c=c||"index",d.iOS?e="detail"==c?"QQVIPFunctionComicDetailViewController":"QQVIPFunctionComicPortalViewController":"detail"==c?(e="cooperation.comic.VipComicJumpActivity",
f.jumpto="com.qqcomic.activity.VipComicTabBrowserActivity"):e="cooperation.comic.VipComicJumpActivity",f.url=a.url,f.from=a.from,f._cfrom=a.from,a.maintab&&(f.maintab=a.maintab),a.extUrlParam&&(f.extUrlParam=a.extUrlParam),
i.invoke("mqq.ui.openView",{name:e,options:f}))},b.openCategory=function(a){var c=this;if(!b.hasClicked)if(b.hasClicked=!0,b.clearClickedTimer(),c.iOS)if(c.compareVersion(c.QQVersion,"6.3.5")>=0){var d=1359554339;
a=c.appendParam(a,"_wv",d),i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicWebViewController",options:{url:a,style:15}})}else if(c.compareVersion(c.QQVersion,"6.3.0")>=0){var d=16778311;a=c.appendParam(a,"_wv",d),
i.invoke("mqq.ui.openUrl",{url:a,target:1})}else if(c.compareVersion(c.QQVersion,"6.0")>=0){var d=269035299;a=c.appendParam(a,"_wv",d),i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicWebViewController",
options:{url:a,style:15}})}else if(c.compareVersion(c.QQVersion,"5.9")>=0){var d=285812515;a=c.appendParam(a,"_wv",d),i.invoke("mqq.ui.openUrl",{url:a,target:1})}else i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicDetailViewController",
options:{url:a}});else c.compareVersion(c.QQVersion,"6.2")>=0&&(a=c.appendParam(a,"_cwv",1)),i.invoke("mqq.ui.openUrl",{url:a,target:1})},b.openComicDetail=function(a){var c=this;if(!b.hasClicked&&a){var d=function(){
b.hasClicked=!0,b.clearClickedTimer(),a.indexOf("detailOther.html")>0?c.openDetailWithoutShortcut(a):c.iOS?c.compareVersion(c.QQVersion,"6.3.5")>=0?(a=b.appendParam(a,"_wv",1359554339),i.invoke("mqq.ui.openView",{
name:"QQVIPFunctionComicWebViewController",options:{url:a,style:12}})):c.compareVersion(c.QQVersion,"6.3.0")>=0?(a=b.appendParam(a,"_wv",16778311),i.invoke("mqq.ui.openUrl",{url:a,target:1})):c.compareVersion(c.QQVersion,"6.0")>=0?(a=b.appendParam(a,"_wv",269035299),
i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicWebViewController",options:{url:a,style:12}})):c.compareVersion(c.QQVersion,"5.9")>=0?(a=b.appendParam(a,"_wv",285812515),i.invoke("mqq.ui.openUrl",{
url:a,target:1})):i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicDetailViewController",options:{url:a}}):(a=b.appendParam(a,"_cwv","1"),i.invoke("mqq.ui.openUrl",{url:a,target:1}))};a.indexOf("html/video.html")>-1?b.getVideoInitPlayParam(function(c){
var e=l.parseUrl(a)||{},f=l.parseQueryString(e.search||"")||{};2!=f.player&&1==c&&(a=b.appendParam(a,"init_player",1),console.log("需要添加参数init_player",a)),d()}):d()}},b.clearClickedTimer=function(){clearTimeout(b.clickedTimer),
b.clickedTimer=setTimeout(function(){b.hasClicked=!1},1500)},b.closeCurrentPage=function(){var a=arguments.callee;b.android&&0!==b.compareQQVersion("7.0")&&i.invoke("mqq.ui.popBack",{}),b.iOS&&!a.bindEvent&&(a.bindEvent=!0,
b.bindPageVisibleEvent(function(a){a.hidden&&setTimeout(function(){i.invoke("mqq.ui.popBack",{})},600)}))},b.openCommonUrl=function(a){var c,d=this;try{var e=l.parseUrl(a).search,f=l.parseQueryString(e);
c=void 0===f.wv_style?4:Number(f.wv_style)}catch(h){c=4}if(!b.hasClicked)if(b.hasClicked=!0,b.clearClickedTimer(),d.iOS&&d.compareVersion(d.QQVersion,"6.7")>=0&&d.compareVersion(d.QQVersion,"7.0")<0)i.invoke("mqq.ui.openView",{
name:"QQWebViewController",options:{url:a,style:c}});else if(d.iOS&&d.compareVersion(d.QQVersion,"6.0")>=0)i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicWebViewController",options:{url:a,style:c}
});else if(d.iOS&&-1==d.compareVersion(d.QQVersion,"5.9"))i.invoke("mqq.ui.openView",{name:"QQVIPFunctionWebIntermediaryViewController",options:{url:a}});else{var j=g.getParams("__iscomic");1==j&&b.android&&b.compareVersion(b.QQVersion,"7.7.0")<0?i.invoke("mqq.ui.openUrl",{
url:a,target:1,useNewConfig:!0}):i.invoke("mqq.ui.openUrl",{url:a,target:1})}},b.openComicDetailInCommon=function(a){var c=this,d="",e={};if(!b.hasClicked)if(b.hasClicked=!0,b.clearClickedTimer(),c.iOS)if(c.compareVersion(c.QQVersion,"5.9")>=0){
var f=g.createUrl("detail",{id:a.id,from:a.from,_bid:354}),h=285812515;f+="&_wv="+h,i.invoke("mqq.ui.openUrl",{url:f,target:1})}else{var f=g.createUrl("detail_simple",{id:a.id,from:a.from,_bid:354});i.invoke("mqq.ui.openUrl",{
url:f})}else d="cooperation.comic.VipComicJumpActivity",e.jumpto="com.qqcomic.activity.VipComicTabBrowserActivity",e.url=g.createUrl("detail",{_cwv:1,id:a.id,_bid:354}),e.from=a.from,e._cfrom=a.from,i.invoke("mqq.ui.openView",{
name:d,options:e})},b.loadImg=function(a,b){var c=this;a="data-"+(a||"url"),b=b||f("body");var d,e=b.find("["+a+"]"),g=0,h=0,i=f(window).scrollTop();j.get("loadImgHeight")?(d=j.get("loadImgHeight"),d||(d=c.iOS?f(window).height():window.screen.availHeight>f(window).height()*window.devicePixelRatio?window.screen.availHeight/window.devicePixelRatio-50:f(window).height())):(d=c.iOS?f(window).height():window.screen.availHeight>f(window).height()*window.devicePixelRatio?window.screen.availHeight/window.devicePixelRatio-50:f(window).height(),
j.set("loadImgHeight",d));for(var k,l=0,n=0;n<e.length;n++)k=f(e[n]),g=k.offset().top||0,h=k.height(),i+d+l>=g&&g+h>=i-l&&k.attr(a)&&!function(b){var c=b.attr(a);"https:"==window.location.protocol&&0==c.indexOf("http:")&&(0==c.indexOf("http://ugc.qpic.cn/")?0==c.indexOf("http://ugc.qpic.cn/manhua_cover")&&(c=c.replace("http://ugc.qpic.cn","https://shp.qpic.cn")):c=c.replace(/^http:/,"https:")),
c=c.replace("imgcache.gtimg.cn","imgcache.qq.com");var d=new Image;d.onload=function(){b.attr(a)&&(b[0]&&"IMG"==b[0].tagName.toUpperCase()?b.attr("src",c):b.css("background-image",'url("'+c+'")'),b.removeAttr(a)),
"data-sectionUrl"==a&&b.parent().addClass("border-b")},d.onerror=function(a){m.send({page_id:"101",tbName:"dc00145",biz_id:"8001",biz_subid:"8001001",oper_obj_type:"100",oper_obj_id:100001,ext2:c})},d.src=c;
}(k)},b.mediator=function(){var a={},b=a.hasOwnProperty;return{subscribe:function(c,d){b.call(a,c)||(a[c]=[]);var e=a[c].push(d)-1;return{remove:function(){delete a[c][e]}}},publish:function(c,d){b.call(a,c)&&a[c].forEach(function(a){
a(void 0!=d?d:{})})}}}(),b.loadCss=function(a){f("<link>").attr({type:"text/css",rel:"stylesheet",href:a}).appendTo("head")},b.writeLog=function(a){setTimeout(function(){(-1==location.href.indexOf("index.html")||"error"!=a.level)&&i.clientLog({
content:a.content||"",level:a.level||"debug"})},0)},e.getPrivateToken=function(){var a="";return b.compareVersion(b.QQVersion,"6.3")>=0&&(a=h.get("pt4_token")||""),a},b.getPrivateToken=e.getPrivateToken,
b.openDetailWithoutShortcut=function(a){b.iOS?(a=b.appendParam(a,"_wv",1091118883),i.invoke("mqq.ui.openView",{name:"QQVIPFunctionComicWebViewController",options:{url:a,style:12}})):(a=b.appendParam(a,"_cwv",1),
a=b.appendParam(a,"_wv",8192),i.invoke("mqq.ui.openUrl",{url:a,target:1}))},b.asyncLoadInstance=function(b,c){var d=arguments.callee;d.instances||(d.instances={}),d.instances[b]||(d.instances[b]={instance:null,
count:0}),d.instances[b].count>4||(d.instances[b].instance?c(d.instances[b].instance):a.async(b,function(a){a?(d.instances[b].instance=a,c(d.instances[b].instance)):(d.instances[b].count++,d.call(d,b,c));
}))},b.getBarHeight=function(a){var c=this;if(b.android)if(c.isComicWebView){var d=parseInt(j.get("vip_comic_client_height"));!isNaN(d)&&d>0?a(d):b.getTitleBarHeight(function(b){var c=Math.floor((0==b.code?b.data.height:50)/window.devicePixelRatio);
a(c),j.set("vip_comic_client_height",c)})}else a(90);else{var e=g.getParams("_wvx"),f=e&&1&e,h=64;window.screen.height>736&&(h=f?44:88),a(h)}},b.markQtaPageShowed=function(a){var b=f(a||"body");setTimeout(function(){
b.data("qta","pageShowed")},0)},b.getCDNStaticUrl=function(a){var b="cdn.vip.qq.com";return window.location.host==b&&(/^https?:\/\/imgcache\.qq\.com/.test(a)?a=a.replace(/^https?:\/\/imgcache\.qq\.com/,"//cdn.vip.qq.com"):/^https?:\/\/imgcache\.gtimg\.cn/.test(a)&&(a=a.replace(/^https?:\/\/imgcache\.gtimg\.cn/,"//cdn.vip.qq.com"))),
"https:"==window.location.protocol&&(0==a.indexOf("http://manhua.qpic.cn")||0==a.indexOf("http://p.qpic.cn")||0==a.indexOf("http://q.logo.cn"))&&(a=a.replace(/^http:/,"")),a=a.replace("imgcache.gtimg.cn","imgcache.qq.com");
},b.getWebViewTypeIsComic=function(a){var b=this,c=arguments.callee;"undefined"==typeof c.isComicWebview?b.iOS?i.invoke("mqq.device.getWebViewType",function(b){7==b?c.isComicWebview=!0:c.isComicWebview=!1,
a(c.isComicWebview)}):b.isComicWebView?(c.isComicWebview=!0,a(c.isComicWebview)):(c.isComicWebview=!1,a(c.isComicWebview)):a(c.isComicWebview)},b.getIfComicOnTheShelf=function(a){if(a){if(3==a.uiStatus&&1!=a.uiOriginStatus)return!0;
if(3==a.comicStatus&&1!=a.iegComicStatus)return!0}return!1},b.getCookie=function(a){if(document.cookie&&""!=document.cookie)for(var b,c=document.cookie.split("; "),d=0,e=c.length,a=encodeURIComponent(a);e>d;d++)if(b=c[d].split("="),
a==b[0])return decodeURIComponent(b[1]||"");return null},b.getUin=function(){var a=b.getCookie("uin")||0;return a=a?String(a).replace(/^o0*/g,""):""}}),define("business/router",["lib/zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","zepto"],function(a,b,c){
function d(a){return 0===a.indexOf("vpcm/")||0===a.indexOf("vp/")||0===a.indexOf("vpor/")||0===a.indexOf("comicapp")||"comic.qq.com"==location.host?!0:!1}function e(a){g.platform.isInBoodo?a.app_from=2:g.platform.isInMqq?a.app_from=1:g.platform.isInWechat?a.app_from=3:g.platform.isPc?a.app_from=8:a.app_from=6;
}function f(a){var b,c=arguments.callee;if(b=c.params?c.params:c.params=i.parseQueryString(window.location.search),a)for(var d=a.split("."),e=0,f=d.length;f>e;e++){if(!b.hasOwnProperty(d[e])){var g=g;return g;
}b=b[d[e]]}return b}var g={},h=a("lib/zepto"),i=a("piggy/util/uri"),j=a("piggy/util/process"),k=a("piggy/util/cookie"),l=a("business/jsbridge"),m=c.exports={};m.params=f();var n=m.params.from=m.params._cfrom?m.params._cfrom:m.params.from?m.params.from:"6",o=m.params.land_page||null,p=m.params.detailpage_from||null,q=m.params._wvx||null,r=m.params.obj_ownerid||null,s=/\/redirect\.html$/.test(location.pathname)?m.params.fromInternal:null;
!function(){Object.defineProperty(window,"LAND_PAGE",{set:function(a){o=a,g.params.land_page=a,g.newParams.land_page=a},get:function(){return o}}),Object.defineProperty(window,"DETAILPAGE_FROM",{set:function(a){
p=a,g.params.detailpage_from=a,g.newParams.detailpage_from=a},get:function(){return p}}),Object.defineProperty(window,"OBJ_OWNERID",{set:function(a){r=a,g.params.obj_ownerid=a,g.newParams.obj_ownerid=a;
},get:function(){return r}})}(),m.excludeShareParams=["land_page","detailpage_from","fromInternal","obj_ownerid"],g.params={ADTAG:null,pageVersion:seajs.pageVersion,platId:/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/.test(navigator.userAgent)?109:110,
from:n,land_page:o,detailpage_from:p,fromInternal:s,obj_ownerid:r,pos:null,_wvx:q,read_params:m.params.read_params||""},g.newParams={tf:null,sid:null,client:null,safekey:null,version:null,channel:null,
_bid:null,refer:null,_wv:null,ADTAG:null,pos:null,ChannelID:null,plat:l.iOS?2:1,qqVersion:l.QQVersion,mqqVersion:l.QQVersion,from:n,land_page:o,detailpage_from:p,fromInternal:s,obj_ownerid:r,read_params:m.params.read_params||""
},g.platform={android:l.android,ios:l.iOS,isInMqq:/QQ\/([\d\.]+)/i.test(navigator.userAgent),isInBoodo:/\bcom\.tencent\.nijigen/i.test(navigator.userAgent),isInWechat:/MicroMessenger\/([\d\.]+)/i.test(navigator.userAgent),
isPc:!l.android&&!l.iOS},g.excludeParams=[],m.ready=function(b,c,d){j.lockNext("ready","business/router",function(e){c?(Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||this,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,
e.prototype=new d,e}),a.async(c,function(){b.apply(null,[m.params].concat(Array.prototype.slice.apply(arguments)));var c=21;"/club/client/comic/release/html/video.html"===location.pathname&&(c=249),setTimeout(function(){
var b=window,d={id:c,furl:"cdn.vip.qq.com"+location.pathname,url:b.location.protocol+"//badjs.vip.qq.com/badjs",ignore:[/QzoneApp is not defined/]};b.BJ_REPORT?b.BJ_REPORT.init(d):a.async("lib/bj-report",function(a){
a.init(d)})},400),setTimeout(function(){a.async("lib/fastclick",function(a){a&&(window.__fastclick=a.attach(document.body));const b=new Event("fastclickready",{bubbles:!0});document.dispatchEvent(b)}),
m.bindTitleBarClick(d)},400)})):b(m.params)},function(a){a(g.params)})},m.createUrl=function(a,b,c){var f=i.parseQueryString(window.location.search),j=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1),k=window.location.protocol,l={};
c=c||[],d(a)&&e(l);for(var n in g.params)g.params.hasOwnProperty(n)&&c.indexOf(n)<0&&g.excludeParams.indexOf(n)<0&&(null!==g.params[n]?l[n]=g.params[n]:"undefined"!=typeof f[n]&&null!==typeof f[n]&&(l[n]=f[n]));
if("redirect"===a&&(delete l.land_page,delete l.detailpage_from,delete l.obj_ownerid),-1===a.indexOf("://")){if(0===a.indexOf("vpcm/")){var o="comic.vip.qq.com";return k+"//"+o+a.substr("vpcm".length)+"?"+h.param(h.extend(!0,{},l,b));
}if(0===a.indexOf("vp/")){var o="vpcm.qq.com";return k+"//"+o+a.substr("vp".length)+"?"+h.param(h.extend(!0,{},l,b))}if(0===a.indexOf("qc/")){var o="qc.vip.qq.com";return k+"//"+o+"/gc/pages"+a.substr("qc".length)+".html?"+h.param(h.extend(!0,{},l,b));
}if("comic.qq.com"==location.host){var o="comic.qq.com";return k+"//"+o+j+a+".html?"+h.param(h.extend(!0,{},l,b))}if("detail"===a)return m.createNewUrl("https://qc.vip.qq.com/gc/pages/detail/comicDetail.html",h.extend(!0,{
_webviewtype:4},l,b));if("otherDetail"===a)return m.createNewUrl("https://qc.vip.qq.com/gc/pages/detail/otherDetail.html",h.extend(!0,{_webviewtype:4},l,b));var o="cdn.vip.qq.com";return k+"//"+o+j+a+".html?"+h.param(h.extend(!0,{},l,b));
}if(/^(.+?)(\?(?:[^#]*))?(#(?:.*))?$/.test(a)){var j=RegExp.$1,p=RegExp.$2.replace(/\{([\d\w]+)\}/g,function(a,b){return"undefined"!=typeof l[b]?l[b].toString():a}),q=RegExp.$3,r=i.parseQueryString(p);return r.uin=1*r.uin||0,
j+"?"+h.param(h.extend(!0,{},r,b))+q}return a},m.createNewUrl=function(a,b,c){var f=i.parseQueryString(window.location.search),j=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1),k=window.location.protocol,l={};
c=c||[],d(a)&&e(l);for(var m in g.newParams)g.newParams.hasOwnProperty(m)&&c.indexOf(m)<0&&g.excludeParams.indexOf(m)<0&&("undefined"!=typeof f[m]&&null!==typeof f[m]?l[m]=f[m]:null!==g.newParams[m]&&(l[m]=g.newParams[m]));
if("redirect"===a&&(delete l.land_page,delete l.detailpage_from,delete l.obj_ownerid),-1===a.indexOf("://")){if(0===a.indexOf("vpcm/")){var n="comic.vip.qq.com";return k+"//"+n+a.substr("vpcm".length)+"?"+h.param(h.extend(!0,{},l,b));
}if(0===a.indexOf("vp/")){var n="comic.vip.qq.com";return k+"//"+n+a.substr("vp".length)+"?"+h.param(h.extend(!0,{},l,b))}if(0===a.indexOf("vpor/")){var n="community.vip.qq.com";return k+"//"+n+a.substr("vpor".length)+"?"+h.param(h.extend(!0,{},l,b));
}if(0===a.indexOf("comicapp")){var n="comicapp.vip.qq.com";return k+"//"+n+a.substr("comicapp".length)+"?"+h.param(h.extend(!0,{},l,b))}if("comic.qq.com"==location.host){var n="comic.qq.com";return k+"//"+n+j+a+".html?"+h.param(h.extend(!0,{},l,b));
}var n="cdn.vip.qq.com";return k+"//"+n+j+a+".html?"+h.param(h.extend(!0,{},l,b))}if(/^(.+?)(\?(?:[^#]*))?(#(?:.*))?$/.test(a)){var j=RegExp.$1,o=RegExp.$2.replace(/\{([\d\w]+)\}/g,function(a,b){return"undefined"!=typeof l[b]?l[b].toString():a;
}),p=RegExp.$3,q=i.parseQueryString(o);return j+"?"+h.param(h.extend(!0,{},q,b))+p}return a},m.getUserId=function(){var a=arguments.callee,b=g.getUin();if(b)return b;a.time||(a.time=Date.now());for(var c=String(a.time),d=5381,e=0,f=c.length;f>e;++e)d+=(d<<5)+c.charAt(e).charCodeAt();
return 2147483647&d},g.getUin=function(){var a=h.extend(!0,{},i.parseQueryString(window.location.search)),b=k.get("uin")||a.uin||0;return b=b?String(b).replace(/^o0*/g,""):""},m.getParams=f,m.bindTitleBarClick=function(a){
var b=arguments.callee;if(!b.binded){b.binded=!0;var c=a||{};if(c=h.extend({disableTitleBarClick:!1,later:1e3,click:null,doubleClick:function(){h(window).scrollTop(0)}},c),!c.disableTitleBarClick&&l.android&&l.compareVersion(l.QQVersion,"6.5.0")>=0){
var d,e=function(){var a=arguments.callee;a.hasRun||(a.hasRun=!0,l.addEventListener("qbrowserTitleBarClick",function(a,b){d?(clearTimeout(d),d=null,c.doubleClick&&c.doubleClick()):d=setTimeout(function(){
d=null,c.click&&c.click()},300)}))};h(document).on("mqqInstanceLoaded",function(){e()}),c.later?setTimeout(function(){e()},c.later):e()}}},m.getDecodeParam=function(a,b){a=a||"read_params";var c=m.params[a]||"",d=m.decodeURIComponent(c);
return b&&(d=d.replace(/_\d+=/g,"=")),d},m.extendReEncodeParam=function(a,b,c){c=c||{};var d=m.getDecodeParam(a,c.cutIndexTail);d&&(b[a]=encodeURIComponent(d))},m.decodeURIComponent=function(a){if(a.indexOf("%")>-1)try{
return a=decodeURIComponent(a),m.decodeURIComponent(a)}catch(b){return a}return a},m.getSubParam=function(a,b){var c="",d=m.getDecodeParam(a)||"",e=new RegExp(b+"=([^&]*)"),f=d.match(e);return f&&f.length>1&&(c=f[1]),
c},m.resourceIdConfig={"fav-history":"19198765432001","fav-collect":"19198765432002","fav-recommend":"19198765432003","fav-openRead":"19198765432004","search-history":"11098765432001","search-hot":"11098765432002",
"search-recommend":"11098765432003","search-result":"11098765432004","category-list":"17898765432001","subpage-banner":"304098765432001","subpage-column":"304098765","read-history":"19298765432001","index-more":"308198765",
"category-limit":"1609876543200","video-recommend":"12098765432001","download-tab":"19398765432001","radar-recommend":"15998765432001","outdate-coin":"306198765432001","download-detail":"305498765432001",
rank:"172987654320","detail-recommend":"10298765432001","coin-task":"309298765432001"},m.getReadParam=function(a,b){b=b||{};var c="",d=m.resourceIdConfig,e=function(a,b){a&&b&&(c.length>0&&(c+="&"),c+=a+"="+b);
},f=function(a,b){b=b||"";var c=d[a]||"";return c+b};if(d[a]){var g=f(a,b.resourceId);g&&e("is_new_24",g)}return encodeURIComponent(c)},m.isReadLink=function(a){return a.indexOf("html/detail.html?")>0||/html\/redirect\.html\?.*action=read(&|$)/.test(a);
}}),define("business/comic",["lib/zepto","business/common","zepto","business/router","piggy/util/cookie","business/jsbridge","piggy/util/cacheData","piggy/util/tpl","piggy/util/uri","piggy/util/report","piggy/util/process","piggy/util/string","widget/WVUtil","piggy/util/net","business/security"],function(a,b,c){
function d(a,b){var c={};c.read_params=a.read_params||"",k.extendReEncodeParam("read_params",c),c.comicID=String(a.id),c.comicSectionID=String(a.sectionID),c.comicPageID=a.pageID?String(a.pageID):"",c.comicPageOffset=a.pageOffset,
c.type=a.type||"",c.from=a.from,c.src=a.src||6,c.returnToDetail=a.returnToDetail||!1,c.comicSectionIndex="undefined"==typeof a.sectionIndex?-1:a.sectionIndex,c.isFullScreen="undefined"==typeof a.isFullScreen?!0:!!a.isFullScreen,
c.player=a.player,c.cloudUrl=a.cloudUrl,a.land_page_id&&(c.land_page_id=a.land_page_id),a.detailpage_from&&(c.detailpage_from=a.detailpage_from),a.prepage&&(c.prepage=a.prepage),a.pos&&(c.pos=a.pos),a.mod&&(c.mod=a.mod),
a.obj_ownerid&&(c.obj_ownerid=a.obj_ownerid),c.alog_id=a.algo_id||0,c.algo_id=a.algo_id||0,c.fromOtherEntry=a.fromOtherEntry||!1,a.read_params&&(c.read_params=a.read_params),k.extendReEncodeParam("read_params",c),
f.compareQQVersion("7.1.0")>=0&&-1===navigator.userAgent.indexOf("V1_AND_SQ_7.3.0_750_HDBM_T")&&f.writeLog({content:["comicReadParamsLog","startRead: ",JSON.stringify(c),";queryString: ",window.location.search].join("|"),
level:"error"});var d=j.comicInvoke?j.comicInvoke:j.invoke;f.compareQQVersion("7.6.0")<0&&1==c.player?j.invoke("mqq.ui.showDialog",{title:"温馨提示",text:"手Q版本太旧,请升级到最新版本!",needOkBtn:!0,needCancelBtn:!0,okBtnText:"升级",
cancelBtnText:"取消"},function(a){a&&0==a.button?f.openCommonUrl("https://im.qq.com/mobileqq/touch/?_wv=7"):a&&1==a.button}):d("mqq.comic.startRead",c,function(a){a.result=a.code,delete a.code,b&&b(a)})}
var e=a("lib/zepto"),f=a("business/common"),g=a("piggy/util/uri"),h=a("piggy/util/cacheData"),i=a("piggy/util/process"),j=(a("piggy/util/string"),a("business/jsbridge")),k=a("business/router"),l=a("widget/WVUtil"),m=(a("piggy/util/net"),
a("business/security")),n={};b.getMusicParam=function(a){var b,c;if(!a)return"";try{return b=g.parseUrl(a),c=g.parseQueryString(b.search),c.songmid||c.albummid||""}catch(d){return""}},b.getBlackList=function(a){
var b=86400,c=600,d="blackList",e=null,g=null,j=+k.getUserId();return h.getWithListStruct({},[d],"comic/blackList",function(a,b,c){i.lockNext(a,"comic/blackList",function(a){c(a&&0==a.result&&a.data?{result:0,
data:{blackList:a.data}}:a)},function(a){var b={module:"comic_mainpage_mt_svr",method:"GetCopyrightInfo",param:{userName:j}};f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:b,
callback:function(b){a(b)}})})},function(b){b&&b.data&&b.data.blackList&&(b.data=b.data.blackList),a(b)},"undefined"==typeof e||null===e?b:e,"undefined"==typeof g||null===g?c:g)},b.get=function(a,b){var c=3600,d=60,g=a.idList,j=null,k=null;
return h.getWithListStruct({},g,"comic/newItem",function(a,b,c){i.lockNext(a,"comic/newItem",function(a){c(a)},function(b){if(n.items){for(var c={},d=0;d<a.length;d++)c[a[d]]=n.items[a[d]];b({result:0,
data:c})}else{var g={src:1,cmd:{detail:{module:"comic",method:"getComicSummaryInfo",param:{comicID:a}}}},i={param:JSON.stringify(g)};f.sendRequest({data:i,callback:function(a){if(a&&a.data&&a.data.detail){
var c=a.data.detail;if(c&&0==c.retCode){var c=c.retBody,d={};if(c&&0==c.result){for(var f=0;f<c.data.length;f++){var g="comic/newItem__"+c.data[f].id,i=h.get(g);d[c.data[f].id]=i?e.extend(!0,i,c.data[f]):c.data[f];
}c.data=d}b(c)}else b({result:-5})}else b({result:-6})}})}})},function(a){b(a)},"undefined"==typeof j||null===j?c:j,"undefined"==typeof k||null===k?d:k)},b.getDetailInfo=function(a,c){b.get(a,c)},b.getComicDetailInfo=function(a,b,c){
var d=a.idList;return h.getWithListStruct({},d,"comic/newItem",function(a,b,c){i.lockNext(a,"comic/newItem",function(a){c(a)},function(b){var c={src:1,cmd:{detail:{module:"comic",method:"getComicSummaryInfo",
param:{comicID:a}}}},d={param:JSON.stringify(c)};f.sendRequest({data:d,plugins:{"piggy/util/time":/^[\w]+:\/\/[\w\-\.]+\.vip\.qq\.com\//},callback:function(a){if(a&&a.data&&a.data.detail){var c=a.data.detail;
if(c&&0==c.retCode){var c=c.retBody,d={};if(c&&0==c.result&&c.data){for(var f=0;f<c.data.length;f++){var g="comic/newItem__"+c.data[f].id,i=h.get(g);d[c.data[f].id]=i?e.extend(!0,i,c.data[f]):c.data[f];
}c.data=d}b(c)}else b({result:-5})}else b({result:-6})}})})},function(a){b(a)},"undefined"!=typeof c?c:function(a){b(a)})},b.setPrivateState=function(a,b){var c={module:"comic_card_collect_mt_svr",method:"SetPrivateSate",
param:{id:a.id+"",state:a.state}};f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:c,callback:function(a){b(a||{})}})},b.getComicReadInfo=function(a,b){var c={src:1,cmd:{readinfo:{
module:"comic",method:"getComicReadInfo",param:{comicID:[a.id]}}}},d={param:JSON.stringify(c)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),data:d,callback:function(a){if(a&&a.data&&a.data.readinfo){
var c=a.data.readinfo;c&&0==c.retCode?(c=c.retBody,b(c)):b({result:-5})}else b({result:-6})}})},b.getComicList=function(a,b){var c={src:1,cmd:{readinfo:{module:"comic",method:"getComicSummaryInfo",param:{
comicID:a}}}},d={param:JSON.stringify(c)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),data:d,callback:function(a){if(a&&a.data&&a.data.readinfo){var c=a.data.readinfo;c&&0==c.retCode?(c=c.retBody,
b(c)):b({result:-5})}else b({result:-6})}})},b.getReadInfo=function(a,b){a.id=a.id||"";var c=j.comicInvoke?j.comicInvoke:j.invoke;c("mqq.comic.getReadInfo",{comicID:String(a.id)},function(a){if(a.result=a.code,
delete a.code,0==a.result&&a.data&&a.data.comicID){var c={result:0};c.id=a.data.comicID,a.data.type&&(c.type=a.data.type),c.name=a.data.comicName,c.chapterID=a.data.comicChapterID,c.sectionID=a.data.comicSectionID,
c.sectionName=a.data.comicSectionName,c.pageID=a.data.comicPageID,c.pageOffset=a.data.comicPageOffset,c.sectionReadStatus=a.data.sectionReadStatus,c.sectionIndex=a.data.comicSectionIndex,c.player=a.data.player,
c.cloudUrl=a.data.cloudUrl,c.sectionImgUrl=a.data.sectionImgUrl,a.data=c}b&&b(a)})},b.read=function(b,c){if(b.not_report===!0)return d(b,c);if((1===b.player||2===b.player)&&f.compareQQVersion("7.6.0")>=0&&!b._notRedirect){
var e=k.createUrl("video",{id:b.id,_bid:354,_cwv:1,pos:b.pos,player:b.player});return void f.openComicDetail(e)}a.async("business/compassReport",function(a){return!a||"function"!=typeof a.getReportInfo||b.noNeedToGetReport?d(b,c):void a.getReportInfo(function(e){
if(e){var f=a.createCurrentPath({page_id:b.pos,oper_obj_id:b.oper_obj_id,ses_id:b.ses_id,ext4:b.ext4,ext8:b.indexGrey});b.land_page_id=e.land_page,b.detailpage_from=e.detailpage_from,b.prepage=f,b.pos=b.pos||e.obj_pos,
b.from=b.from||e.from||6,b.algo_id=e.algo_id||0,b.obj_ownerid=e.obj_ownerid}d(b,c)})})},b.readByProxy=function(a,b){var c={};c.comicID=String(a.id),c.comicSectionID=String(a.sectionID),c.comicPageID=String(a.pageID),
c.comicPageOffset=a.pageOffset,c.returnToDetail=a.returnToDetail||!1,k.extendReEncodeParam("read_params",c),j.invoke("mqq.ui.openView",{name:"cooperation.comic.VipComicJumpActivity",options:{jumpto:a.jumpto,
from:a.from,comic:c}})},b.openQQbrowser=function(a,b){j.invoke("mqq.comic.openQQBrowser",{url:a.url,target:a.target})},b.openByNormalWebview=function(a){var b=this;f.hasClicked||(f.hasClicked=!0,f.clearClickedTimer(),
f.android?b.openQQbrowser(a):f.iOS&&(f.compareVersion(f.QQVersion,"5.9")>=0?j.invoke("mqq.ui.openUrl",{url:a.url,target:1}):j.invoke("mqq.ui.openView",{name:"QQVIPFunctionWebIntermediaryViewController",
options:{url:a.url}})))},b.getSectionPictureUrl=function(a,b){var c="";return c=window.location.protocol+"//cdn.vip.qq.com/club/mobile/profile/comic_center/"+a.id+"/section/"+b.sectionID+".jpg?max_age=31536000";
},b.getChapterPictureUrl=function(a,b){var c="";return c=window.location.protocol+"//cdn.vip.qq.com/club/mobile/profile/comic_center/"+a.id+"/chapter/"+b.chapterID+".jpg?max_age=31536000"},b.getCoverPictureUrl=function(a){
var b="";return b=1==a.coverImgStyle?window.location.protocol+"//cdn.vip.qq.com/club/mobile/profile/comic_center/"+a.id+"/cover/"+a.id+".jpg?max_age=31536000":a.coverImg},b.getBgPictureUrl=function(a){
var b="";return b=window.location.protocol+"//cdn.vip.qq.com/club/mobile/profile/comic_center/"+a.id+"/background/"+a.id+".jpg?max_age=31536000"},b.handleUrl=function(a){var c,d,e;if(a&&"string"==typeof a)try{
c=g.parseUrl(a),d=g.parseQueryString(c.search),e=c.pathname,d.external?b.openByNormalWebview({url:a}):e.indexOf("category.html")>-1?f.openCategory(a):e.indexOf("detail.html")>-1||e.indexOf("video.html")>-1?f.openComicDetail(a):f.openCommonUrl(a);
}catch(h){}},b.setComicActive=function(a,b){var c;if(a.id&&a.type){if(f.compareVersion(f.QQVersion,"6.5.5")<0)return void j.invoke("mqq.comic.setComicActive",{comicID:a.id},function(a){a.result=a.code,
delete a.code,b&&b(a)});a.opTs&&(c=a.opTs),f.getNowTime(function(a,c,d){return function(e){var g={module:"comic_collect",method:"setReadComicDetailTime",param:{id:String(a),type:Number(c),opTs:Number(d?d:(e/1e3).toFixed(0))
}};f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/coupon_coin"),data:g,callback:function(a){if(a&&0===a.result){if(b&&b({result:0}),a.data&&a.data.redTouchOff){var c=f.iOS?"1148.100801":"1113.100801";
j.invoke("mqq.redpoint.getAppInfo",{path:c},function(a){if(a&&0===a.code&&a.data){var b=a.data;b.iNewFlag=0,j.invoke("mqq.redpoint.setAppInfo",{appInfo:b},function(a){}),j.invoke("mqq.redpoint.reportRedTouch",{
path:c,isWithRedPoint:1},function(a){})}})}}else b&&b({result:-1})}})}}(a.id,a.type,a.opTs))}},b.getGroupTribeList=function(a,b){var c=window.location.protocol+"//buluo.qq.com/cgi-bin/bar/extra/batch_bar";
e.ajax({type:"GET",url:c,data:{bids:JSON.stringify([a.groupTribeId])},dataType:"jsonp",success:function(a){0==a.retcode&&a.result.bars&&(a.result.bars[0].fansDesc=a.result.bars[0].fans>1e4?parseInt(a.result.bars[0].fans/1e4)+"万人":a.result.bars[0].fans+"人"),
b&&b(a)},error:function(){b&&b({retcode:-5})}})},b.getMantuInfo=function(a,b){var c="11840",d={};d[c]={req:{comicId:a.comicId}},e.ajax({type:"post",url:window.location.protocol+"//proxy.vac.qq.com/cgi-bin/srfentry.fcgi?g_tk="+m.getCSRFToken(),
dataType:"json",data:JSON.stringify(d),timeout:6e4,success:function(a){if(a&&a[c]&&0==a[c].ret&&a[c].data&&a[c].data.rsp){var d=a[c].data.rsp;0==d.total?d.fansDesc="快点来玩":d.fansDesc=d.total>1e4?parseInt(d.total/1e4)+"万张图":d.total+"张图",
b&&b({data:d,ret:0})}else b&&b({ret:-1})},error:function(){b&&b({ret:-5})}})},b.getComicIntelligence=function(a,b,c){var d=604800,e=3600,g="intelligenceV2_"+a.id,c=c||null,j=null;return h.getWithListStruct({},[g],"comic/intelligence",function(b,c,d){
i.lockNext(b,"comic/intelligence",function(a){if(a&&0==a.result&&a.data){var c={result:0,data:{}};c.data[b]=a.data,d(c)}else d(a)},function(b){if(a.old){var c={src:1,cmd:{intelligence:{module:"comic",method:"getComicIntelligence",
param:{comicID:[a.id]}}}},d={param:JSON.stringify(c)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),data:d,callback:function(a){if(a&&a.data&&a.data.intelligence){var c=a.data.intelligence;
b(c&&0==c.retCode?c.retBody:{result:-5})}else b({result:-5})}})}else f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi?"),data:{module:"comic_basic_operate_mt_svr",method:"GetComicTag",
param:{comicID:[a.id]}},callback:function(a){a&&a.data&&a.data.list&&0===a.result?(a.data=a.data.list,b(a)):b({result:-5})}})})},function(a){a&&0==a.result&&a.data[g]&&(a.data=a.data[g]),b(a)},"function"==typeof c?function(a){
a&&0==a.result&&a.data[g]&&(a.data=a.data[g]),c(a)}:d,"undefined"==typeof j||null===j?e:j)},b.getCollectStatus=function(a,b){var c=j.comicInvoke?j.comicInvoke:j.invoke;c("mqq.comic.getCollectStatus",{comicIDList:String(a.id)
},function(a){a.result=a.code,delete a.code,b&&b(a)})},b.collect=function(b,c,d){var e=function(a){a.comicID=String(b.id),a.comicName=b.name,a.type=a.type||0,a.bgUrl=b.coverImg,a.page_id=String(a.page_id)||"",
a.land_page_id=String(a.land_page_id)||"",a.detailpage_from=String(a.detailpage_from)||"",a.from=String(a.from)||"",a.obj_ownerid=String(a.obj_ownerid)||"",k.extendReEncodeParam("read_params",a),j.invoke("mqq.comic.collectComic",a,function(a){
a.result=a.code,delete a.code,d&&d(a)})};f.compareQQVersion("7.1")>=0?a.async("business/compassReport",function(a){return a&&"function"==typeof a.getReportInfo?void a.getReportInfo(function(a){a&&(c.land_page_id=a.land_page,
c.detailpage_from=a.detailpage_from,c.obj_ownerid=a.obj_ownerid),e(c)}):e(c)}):e(c)},b.getRecommendForYouList=function(a){var b={src:1,cmd:{readinfo:{module:"comic",method:"getRecommendForYou",param:{}
}}},c={param:JSON.stringify(b)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),data:c,callback:function(b){if(b&&b.data&&b.data.readinfo){var c=b.data.readinfo;c&&0==c.retCode?(c=c.retBody,
a(c)):a({result:-5})}else a({result:-5})}})},b.getPubUpdateMsgStatus=function(a,b){var c=!0,d=!0,e=k.getUserId(),g="updateSetting",j="comic/"+g+e,l=null,m=null;return h.getWithListStruct({},[g],j,function(a,b,c){
i.lockNext(a,"comic/updateSetting",function(b){if(b&&0==b.result&&b.data){var d={result:0,data:{}};d.data[a]=b.data,c(d)}else c(b)},function(a){var b={src:1,cmd:{updateSetting:{module:"comic",method:"getPubUpdateMsgStatus",
param:{}}}};({param:JSON.stringify(b)}),f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"comic_collect",method:"getPubUpdateMsgStatus",param:{}},callback:function(b){
if(b&&b.data){var c=b.data;a(c&&0==c.ret?b:{result:-5})}else a({result:-5})}})})},function(a){a&&0==a.result&&a.data[g]&&(a.data=a.data[g]),b(a)},"undefined"==typeof l||null===l?c:l,"undefined"==typeof m||null===m?d:m);
},b.setPubUpdateMsgStatus=function(a,b){var c={src:1,cmd:{settingUpdate:{module:"comic",method:"setPubUpdateMsgStatus",param:{type:a.type,isOpen:a.isOpen}}}};a.comicId&&(c.cmd.settingUpdate.param.id=a.comicId),
{param:JSON.stringify(c)},i.lockNext(a.type+"_"+(a.comicId||""),"comic/settingUpdate",function(a){b(a)},function(a){f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"comic_collect",
method:"setPubUpdateMsgStatus",param:c.cmd.settingUpdate.param},callback:function(b){if(b&&b.data){var c=b.data;a(c&&0==c.ret?b:{result:-5})}else a({result:-5})}})})},b.getMyCollectComic=function(a,b){
var c=!0,d=!0,g=0,j=1e3,l=10,m=k.getUserId(),n=null;if(a["@limit"]){var o=String(a["@limit"]).split("to");parseInt(o[0])<parseInt(o[1])&&(g=parseInt(o[0])||0,j=parseInt(o[1])||0),n=[g,j].join("to")}else parseInt(a["@pageIndex"])>=1?(parseInt(a["@pageSize"])>0&&(l=parseInt(params["@pageSize"])),
g=(parseInt(a["@pageIndex"])-1)*l,j=parseInt(a["@pageIndex"])*l,n=[g,j].join("to")):a.idList&&(n=a.idList);return h.getWithListStruct({},n,"comic/getMyCollectComic"+m,function(b,c,d){var g={src:1,cmd:{
comicList:{module:"comic",method:"getMyCollectComic",param:{isGetFocus:a.isGetFocus||0}}}},h=g.cmd.comicList.param;if("string"==typeof b){var j=b.split("to");h.start=parseInt(j&&j[0])||0,h.end=parseInt((j&&j[1])-1)||0;
}else{if(!e.isArray(b)||0==b.length)return void d({result:-1,message:"params error"});h.idList=b}var l={param:JSON.stringify(g)};i.lockNext(JSON.stringify(l),"comic/getMyCollectComic",function(a){d(a)},function(a){
f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"comic_collect",method:"getPubUpdateMsgStatusList",param:h},callback:function(c){if(c&&c.data){var d=c.data;a(d&&0==d.ret?"array"==e.type(b)&&d&&d.index?{
result:0,data:d.index}:c:{result:-5})}else a({result:-5})}})})},function(a){a&&0==a.result&&a.data.comicList&&(a.count=a.data.comicList.length,a.data=a.data.comicList),b(a)},"undefined"==typeof expire||null===expire?c:expire,"undefined"==typeof update||null===update?d:update);
},b.checkWhiteList=function(a){var b={src:1,cmd:{whitelist:{module:"comic",method:"checkWhiteList",param:{}}}},c={param:JSON.stringify(b)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),
data:c,callback:function(b){if(b&&b.data&&b.data.whitelist){var c=b.data.whitelist;c&&0==c.retCode?(c=c.retBody,a(c)):a({result:-5})}else a({result:-6})}})},b.getShortcutUrl=function(a){var b="";return b=window.location.protocol+"//cdn.vip.qq.com/club/mobile/profile/comic_center/"+a+"/cover/"+(f.iOS?"big":"small")+".png?max_age=604800";
},b.createShortcut=function(a){j.invoke("mqq.comic.createShortcut",a,function(a){a&&0==a.code?f.showTips("添加快捷方式到桌面成功",{iconMode:1}):a&&1==a.code?f.showTips("您已添加过该快捷方式"):f.showTips("已添加,若未找到请查看相关系统权限设置",{
iconMode:1})})},b.setShortcutOption=function(a){j.invoke("mqq.comic.setShortcutOption",a,function(a){0==a.code?f.showTips("添加快捷方式参数成功"):f.showTips("添加快捷方式参数失败")})},b.getResourceUrl=function(a,b){var c={
src:1,cmd:{resource:{module:"comic",method:"getResourceUrl",param:a}}},d={param:JSON.stringify(c)};f.sendRequest({url:k.createUrl("vpcm/cgi-bin/get_comic_mainpage"),data:d,callback:function(a){if(a&&a.data&&a.data.resource){
var c=a.data.resource;c&&0==c.retCode?(c=c.retBody,b(c)):b({result:-5})}else b({result:-6})}})},b.pushTaskData=function(){f.sendMergeRequest({url:k.createUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{
module:"comic_task",method:"DoTaskReward",param:{id:4,taskType:2}}})},b.getActivityBaseData=function(a,b,c){var d=259200,e=86400,g="activityBaseData";return h.getWithListStruct({},[g],["comic/activityBaseData",k.getUserId()].join("_"),function(a,b,c,d){
i.lockNext(a,"comic/activityBaseData",function(a){c(a&&0==a.result&&a.data?{result:0,data:{activityBaseData:a.data}}:a)},function(a){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/comic_grab_floor"),
data:{module:"comic_grab_floor",method:"getActivityBaseData",param:{}},callback:function(b){a(b)}})})},function(b){b&&b.data&&b.data[g]&&(b.data=b.data[g]),a(b)},"undefined"==typeof b||null===b?d:b,"undefined"==typeof c||null===c?e:c);
},b.getCGICollectStatus=function(a,b){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"comic_new_collect_mt_svr",method:"GetCollectStatus",param:{ids:[{id:a.id,
type:a.type}]}},callback:function(a){a&&0==a.result&&a.data&&a.data.list&&(a.data=a.data.list),b(a)}})},b.collectArticle=function(a,b,c){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),
data:{module:"comic_new_collect_mt_svr",method:"SetCollectStatus",param:{id:a.id,type:a.type,status:b,read_params:a.read_params,ext1:a.ext1,land_page:a.land_page,detailpage_from:a.detailpage_from,mod:a.mod,
obj_ownerid:a.obj_ownerid}},callback:function(a){c(a)}})},b.modifyPrivateStatusFromCache=function(a,b){var c="comic/newItem__"+a,d=h.get(c);d&&(d.isPrivate=0|b,h.set(c,d)),c="comic/private__"+a+"_"+k.getUserId(),
d={},d.isPrivate=0|b,h.set(c,d)},b.getPrivateStatusFromCache=function(a){var b="comic/private__"+a+"_"+k.getUserId(),c=h.get(b)||{};return c.isPrivate},b.openCurrentProgressRead=function(a,c){var d=this;
a&&a.source?d.setComicRead(a,function(){a.readUrl?(l.openOuterComic(a.readUrl),c&&c({result:0})):c&&c({result:-1,message:"打开失败，缺少阅读器链接。"})}):b.getReadInfo({id:a.id},function(d){d&&0==d.result&&d.data&&d.data.type==a.type&&(a=e.extend({},a,d.data)),
b.read(a,c)})},b.setComicRead=function(a,b){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/coupon_coin")+"&imei="+a.imei,data:{module:"comic_outer_comic_func_mt_svr",method:"saveOuterReadProgress",
param:{comicID:a.id,sectionID:a.sectionID}},callback:function(a){b&&b()}})},b.saveReadProgress=function(a,b){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi",{fromWeb:1,imei:a.imei,
os:f.android?109:110,app_from:1}),data:{module:"comic_basic_operate_mt_svr",method:"SaveReadProgress",param:a},callback:function(a){b&&b(a)}})},b.getTalentPushMsgStatus=function(a,b){f.sendMergeRequest({
url:k.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"SubscribeOperateServer",method:"GetUserPostSubscribe",param:{uin:k.getUserId()}},callback:function(a){a&&0==a.result&&a.data&&a.data.list&&(a.data=a.data.list),
b(a)}})},b.setTalentPushMsgStatus=function(a,b){f.sendMergeRequest({url:k.createNewUrl("vpcm/cgi-bin/comic_common_asyn_cgi"),data:{module:"SubscribeOperateServer",method:"SetUserPostSubscribe",param:{isSubscribe:a&&a.isSubscribe||0
}},callback:function(a){a&&0==a.result&&a.data&&a.data.list&&(a.data=a.data.list),b(a)}})}}),define("business/jsbridge",["lib/zepto"],function(a,b,c){function d(a,c,d,e){function f(){var a={r:-201,result:"error"
};window.mqq&&mqq.execGlobalCallback?mqq.execGlobalCallback(e,a):"function"==typeof window[e]&&window[e](a)}var g=void 0,h=document.createElement("iframe");return h.style.cssText="display:none;width:0px;height:0px;",
b.iOS&&(h.onload=f,h.src=a),(document.body||document.documentElement).appendChild(h),b.android&&(h.onload=f,h.src=a),setTimeout(function(){h&&h.parentNode&&h.parentNode.removeChild(h)},500),g}var e=a("lib/zepto"),f={},g=navigator.userAgent,h=/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/,i=/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/;
REGEXP_WK=/\bCore\/WKWebView/,document.oncontextmenu=function(){window.event.returnValue=!1},b.compareVersion=function(a,b){a=String(a).split("."),b=String(b).split(".");try{for(var c=0,d=Math.max(a.length,b.length);d>c;c++){
var e=isFinite(a[c])&&Number(a[c])||0,f=isFinite(b[c])&&Number(b[c])||0;if(f>e)return-1;if(e>f)return 1}}catch(g){return-1}return 0},b.iOS=h.test(g),b.android=i.test(g),b.isWK=REGEXP_WK.test(g),b.iOS&&b.android&&(b.iOS=!1),
b.android&&(b.QQVersion=function(a){return a&&(b.compareVersion(a[1],a[3])>=0?a[1]:a[3])||0}(g.match(i))),b.iOS&&(b.QQVersion=function(a){return a&&a[3]||0}(g.match(h))),b.invoke=function(a,c,d){var a=a.split(".");
if(b.iOS&&b.isWK&&void 0===d&&(d=function(){}),a.length>1){if(a.length>2)var e=a[a.length-2],g=a[a.length-1];else var e=a[a.length-1],g=null;return f.invoke(e,g,c,d)}},b.dispatchEvent=function(a,b,c){f.getMqqInstance(function(d){
d.dispatchEvent(a,b,c)})},b.addEventListener=function(a,b){f.getMqqInstance(function(c){c.addEventListener(a,function(a,c){b({data:a,source:c})})})},b.preloadMqqInstance=function(a){f.getMqqInstance(function(b){
a&&a(b)})},f.getMqqInstance=function(b){var c=this,d=arguments.callee;d.error||(d.error=0),d.error>=10||(c.mqqInstance?b(c.mqqInstance):a.async("qqapi",function(a){a?(c.mqqInstance=a,b(c.mqqInstance),d.triggerMqqLoaded||(e(document).trigger("mqqInstanceLoaded"),
d.triggerMqqLoaded=!0)):(d.error++,d.call(f,b))}))},f.invoke=function(a,b,c,d){f.getMqqInstance(function(e){e[a]&&!b||e[a]&&e[a][b]?c&&"function"!=typeof e[a]?b&&e[a][b]?e[a][b].call(e,c,function(){if("function"==typeof d){
var c=Array.prototype.slice.call(arguments);try{d.apply(null,c)}catch(g){throw new Error(g+", ns: "+a+", method: "+b)}f.logCb(e,a+"."+b,c)}}):e[a].call(e,c,function(){if("function"==typeof d){var b=Array.prototype.slice.call(arguments);
d.apply(null,b),f.logCb(e,a,b)}}):d("function"==typeof e[a]?e[a].call(e,c):e[a]):("function"==typeof d&&(c.callback=e.callback(function(){var c=Array.prototype.slice.call(arguments);d.apply(null,c),f.logCb(e,a+"."+b,c);
})),e.invoke(a,b,c))})};var j=1;f.comicInvoke=function(a,b,c,f){var g="jsbridge://"+encodeURIComponent(a)+"/"+encodeURIComponent(b),h="__MQQ_COMIC_"+j++;return window[h]=f,g+="?p="+encodeURIComponent(JSON.stringify(e.extend({},c,{
callback:h}))),d(g,a,b,h),null},b.comicInvoke=function(a,c,d){var e,g;return a=a.split("."),b.iOS&&b.isWK&&void 0===d&&(d=function(){}),a.length>1?(a.length>2?(e=a[a.length-2],g=a[a.length-1]):(e=a[a.length-1],
g=null),f.comicInvoke(e,g,c,d)):void 0},f.logCb=function(a,c,d){b.clientLog({content:["mqqLog",c||"",JSON.stringify(d)].join("|")})},b.clientLog=function(a){function c(a){"error"===a.level?console.error([a.id||"qqcomic",a.subid||"jsLog",a.content||""].join("|")):console.log([a.id||"qqcomic",a.subid||"jsLog",a.content||""].join("|"));
}function d(a){e.invoke("mqq.debug.detailLog",{id:a.id||"qqcomic",subid:a.subid||"jsLog",content:a.content||"",level:a.level||"debug"})}var e=this;if(e.android&&e.compareVersion(e.QQVersion,"7.3.0")>-1)"error"===a.level?b.clientLog.isEnable?c(a):e.invoke("mqq.qw_debug.enableConsoleBlackList",{},function(e){
0===e.code?(c(a),b.clientLog.isEnable=!0):d(a)}):c(a);else if(e.android&&e.compareVersion(e.QQVersion,"7.0.0")>-1&&"error"!==a.level)c(a);else try{d(a)}catch(f){}}}),define("widget/redpoint",["lib/zepto","business/router","zepto","piggy/util/uri","piggy/util/process","piggy/util/cookie","business/jsbridge","business/security","business/common","piggy/util/cacheData","piggy/util/tpl","piggy/util/report"],function(a,b,c){
var d=a("lib/zepto"),e=a("business/router"),f=a("business/jsbridge"),g=a("business/security"),h=a("business/common"),i={dynamic:{id:h.iOS?"1148":"1113",sub:{index:"100800",community:"100802",group:"100803",
category:"100804"}},more:{id:h.iOS?"100600.100001148":"100600.100001113",sub:{index:"100100800",community:"100100802",group:"100100803",category:"100100804"}}},j="";b.queryDyanmicStatus=function(a,b){var c,d=(arguments.callee,
function(a){b&&b({result:-1,errorMessage:a})});a.path?(c=setTimeout(function(){d("interface timeout")},1e4),f.invoke("mqq.redpoint.getDynamicState",{path:a.path},function(a){clearTimeout(c),a&&"undefined"!=typeof a.ret&&(a.result=a.ret,
delete a.ret),b&&b(a)})):d("params error")},b.setDynamic=function(a,b){var c=arguments.callee,d=function(a){b&&b({result:-1,errorMessage:a})};a.path?(c.timeout=function(){d("interface timeout")},f.invoke("mqq.redpoint.setDynamicState",{
path:a.path,type:a.type},function(a){c.timeout&&clearTimeout(c.timeout),a&&"undefined"!=typeof a.ret&&(a.result=a.ret,delete a.ret),b&&b(a)})):d("params error")},b.getComicRedpointInfo=function(a,b){var c=this;
c.queryDyanmicStatus({path:i.dynamic.id},function(c){if(c&&0==c.result){var d=1==c.type?i.dynamic:i.more,e="";d.sub[a]&&(e=[d.id,d.sub[a]].join("."),j=d.sub[a],f.invoke("mqq.redpoint.getAppInfo",{path:e
},function(a){if(0==a.code){a.result=a.code;try{a.data.buffer=JSON.parse(a.data.buffer)}catch(c){a.data.buffer=null}}b&&b(a)}))}else b&&b(c)})},b.setComicRedpointRead=function(a,b){var c=this;if(a){if(a.buffer){
for(var d in a.buffer.msg){var e=a.buffer.msg[d],g=e.content;g="object"==typeof g?JSON.stringify(g):g,e.content=g}a.buffer=JSON.stringify(a.buffer)}f.invoke("mqq.redpoint.setAppInfo",{appInfo:a},function(d){
a.buffer&&(a.buffer=JSON.parse(a.buffer),c.reportMsgShow(j,d.code,a,b))})}},b.reportMsgShow=function(a,b,c,f){var i=e.getParams("isRed"),j={cmd:"16",uin:e.getUserId(),platid:h.iOS?"110":"109",qqver:h.QQVersion,
osver:"",appid:a,ret:String(b),type:String(0),isred:i?String(i):"0",mission:[],set:"1"},k=c.buffer;for(var l in k.msg)if(k.msg[l].content){var m=k.msg[l].content;m="object"==typeof m?m:JSON.parse(m),m.tab==f&&2==k.msg[l].stat&&j.mission.push({
id:String(l),text:"",stat:String(k.msg[l].stat)})}d.ajax({type:"post",url:window.location.protocol+"//h5.vip.qq.com/p/red/cgi-bin/srfentry.fcgi?g_tk="+g.getCSRFToken(),dataType:"json",data:JSON.stringify({
10337:{sReq:JSON.stringify(j)}}),timeout:6e4,success:function(){},error:function(){}})},b.isSupported=function(){return h.android&&h.compareVersion(h.QQVersion,"6.2")>=0||h.iOS&&h.compareVersion(h.QQVersion,"6.5")>=0;
},b.path=i}),define("widget/login",["lib/zepto"],function(a,b,c){var d=a("lib/zepto"),e='<div id="login_div" style="z-index:1000;overflow:hidden;position:absolute; width:100%; height:100%; padding:0; margin:0px;left:0px;top:0px;" align="center"><iframe id="login_frame" name="login_frame" style="overflow:hidden;" frameborder="0" scrolling="no" width="100%" height="100%" src=""></iframe></div>',f=navigator.userAgent,g={};
window.ptlogin2_onResize=function(a,b){},window.ptlogin2_onClose=function(){},g.initEvents=function(){window.onmessage=function(a){if(a){var b=JSON.parse(a.data);switch(b.action){case"close":ptlogin2_onClose();
break;case"resize":ptlogin2_onResize(b.width,b.height);break;case"login_suc":g.loginSuc()}}}},g.init=function(){this.initEvents()},g.loginSuc=function(){"function"==typeof g.callback?(d("#login_div").remove(),
g.callback()):window.location.reload()},b.openLogin=function(a){var b=arguments.callee;if(!b.open){var c=window.location,h=c.protocol+"//"+c.hostname+c.pathname;""!=c.search&&(h+="?"+encodeURIComponent(c.search.substring(1)));
var i="";c.hostname.indexOf("imgcache.qq.com")>-1?i="&daid=420":c.hostname.indexOf("vip.qq.com")>-1&&(i="&daid=18");var j="https:"==c.protocol?"https://ssl.ui.ptlogin2.qq.com/cgi-bin/login?":"http://ui.ptlogin2.qq.com/cgi-bin/login?",k=[j,"hide_title_bar=1","&no_verifyimg=1","&style="+(/iphone|ipad|itouch/gi.test(f)?8:9),"&link_target=blank","&appid=8000212","&target=top",i,"&s_url="+h].join("");
0==d("#login_div").length&&d("body").append(e),g.callback=a,d("body").children().hide(),d("#login_div").show(),d("#login_frame").attr("src",k),b.open=!0}}}),define("widget/dialog",["lib/zepto","piggy/util/tpl"],function(a,b,c){
var d=a("lib/zepto"),e=a("piggy/util/tpl"),f={};f.dialogTpl='	<div class="ui-dialog show" id="dialogMsg"><div class="ui-dialog-cnt"><div class="ui-dialog-bd"><%if(title){%><h4><%=title%></h4><%}%><div><%=content%></div></div><div class="ui-dialog-ft ui-btn-group"><% for (var i = 0; i < button.length; i++) { %><button type="button" id="dialogButton<%=i%>"><%=button[i]%></button><% } %></div></div></div>',
b.show=function(a,b){function c(){return!1}d("#dialogMsg").size()>0&&d("#dialogMsg").remove();var g=[];d.isArray(a.button)?g=a.button:a.button?g.push(a.button):g.push("确认");var h=e.get(f.dialogTpl,{content:a.content||"",
button:g,title:a.title||"",select:a.select||0});d(h).appendTo(d("body")),a.allowScroll?d.each(g,function(a,c){d("#dialogButton"+a).bind("click",function(c){d("#dialogMsg").remove(),b&&b({result:0,data:a
})})}):(d("#dialogMsg").on("touchmove",c),d.each(g,function(a,e){d("#dialogButton"+a).bind("click",function(e){d("#dialogMsg").remove(),b&&b({result:0,data:a}),d("#dialogMsg").off("touchmove",c)})}))}}),
define("business/srfMergeRequest",["lib/zepto","piggy/util/uri","piggy/util/net"],function(a,b,c){var d=c.exports,e=a("lib/zepto"),f=a("piggy/util/uri"),g=a("piggy/util/net"),h={};h.config={options:{dataType:"json",
cache:!1,timeout:0,xhrFields:{withCredentials:!0},plugins:{"business/security":!0,"piggy/business/cgiReport":["merge","ecode"],"business/sequence":!0},type:"POST"},params:{}},h.mapping={},d.init=function(a,b){
b?h.config=a:h.config=e.extend(!0,h.config,a)},d.getPluginHandlers=function(a){return{ajaxStart:function(a,b,c){var d=String(c.url).split("?")[0];h.mapping[d]&&h.mapping[d].proxyXhr&&h.mapping[d].optionList||(h.mapping[d]={
proxyXhr:e.ajaxSettings.xhr(),optionList:[],headers:{},interval:0,instance:null}),c.realTimeout=c.timeout,c.timeout=0,c.xhr=function(a,b){return function(){return a.open=function(){},a.send=function(){
1===b.optionList.push(c)&&setTimeout(function(){b.proxyXhr.send=function(a){return function(){for(var c=["readyState","response","responseText","responseType","responseXML","status","statusText"],d=["abort","error","load","loadend","loadstart","progress","timeout","readystatechange"],f=0,g=d.length;g>f;f++)!function(a,d){
b.proxyXhr[a]=function(){var f,g;if(d&&(g=d.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))),"onreadystatechange"===a&&4==b.proxyXhr.readyState&&!/^\s*$/.test(b.proxyXhr.responseText))try{f=e.parseJSON(b.proxyXhr.responseText);
}catch(h){f=JSON.stringify({result:h.number||-1,message:h.message||h.name||"parseError"})}for(var i=0,j=b.optionList.length;j>i;i++){var k=b.optionList[i].xhr();if("function"==typeof k[a]){for(var l=0,m=c.length;m>l;l++)if(f&&"responseText"===c[l])if("string"==typeof f)k[c[l]]=f;else if(f[b.optionList[i].cgiId]){
var n;n=f[b.optionList[i].cgiId].data?f[b.optionList[i].cgiId].data.rsp:{},k[c[l]]=JSON.stringify({result:f[b.optionList[i].cgiId].ret,data:n,message:f[b.optionList[i].cgiId].msg})}else f.data&&f.data[i]?f.data[i].retBody?k[c[l]]=JSON.stringify(f.data[i].retBody):k[c[l]]=JSON.stringify({
result:f.data[i].retCode||-1,message:f.data[i].retMsg||"retBody nofound"}):k[c[l]]=JSON.stringify({result:f.ecode||-1,message:"key nofound"});else try{k[c[l]]=b.proxyXhr[c[l]]}catch(h){}k[a]&&k[a].apply(k,Array.prototype.slice.call(arguments,0));
}}return d?g:void 0}}("on"+d[f],b.proxyXhr["on"+d[f]]);return a.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))}}(b.proxyXhr.send);for(var a={},c=e.extend(!0,{merge:b.optionList.length},h.config&&h.config.params),i=6e4,j=0,k=b.optionList.length;k>j;j++)a[b.optionList[j].cgiId]=b.optionList[j]&&b.optionList[j].data&&e.extend(!0,{},b.optionList[j].data),
c=e.extend(!0,c,f.parseQueryString(f.parseUrl(b.optionList[j].url).search)),i=Math.max(i,b.optionList[j].realTimeout||0);b.instance=g.ajax(e.extend(!0,{},h.config&&h.config.options,{url:d+"?"+e.param(c),
timeout:i,data:JSON.stringify(a),headers:b.headers,xhr:function(){return b.proxyXhr},error:function(a,c,d){if("timeout"===c||"abort"===c)for(var f,g=0,h=b.optionList.length;h>g;g++)f=e.extend(!0,{},b.optionList[g]||{}),
"function"==typeof f.error&&f.error(a,c,d),f.context&&(f.data=f.data&&e.param(f.data,f.traditional),f.url=f.data?(f.url+"&"+f.data).replace(/[&?]{1,2}/,"?"):f.url,e(f.context).trigger(e.Event("ajaxError"),[f.xhr,f,c]));
}})),h.mapping[d]=null},0)},a.getDuration=function(){return b.instance&&"function"==typeof b.instance.getDuration?b.instance.getDuration.apply(this,Array.prototype.slice.call(arguments,0)):0},a.getAllResponseHeaders=function(){
return b.proxyXhr.getAllResponseHeaders.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0))},a.getResponseHeader=function(){return b.proxyXhr.getResponseHeader.apply(b.proxyXhr,Array.prototype.slice.call(arguments,0));
},a.setRequestHeader=function(a,c){b.headers[a]=c},a}}((c.xhr||e.ajaxSettings.xhr)(),h.mapping[d])}}}});